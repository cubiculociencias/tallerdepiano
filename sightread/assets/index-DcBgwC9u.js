import{u as oe,j as ie,b as ae}from"./context-kPolJz0x.js";import{a as w,r as ce,R as Tt}from"./chunk-PVWAREVJ-BeAWct5i.js";import{f as ue,g as le,p as _t}from"./Canvas-C5qiJpk2.js";function tn(){const t=oe(),e=ie(t.state);return w.useMemo(()=>({canPlay:e!=="CannotPlay",playing:e==="Playing",paused:e==="Paused"}),[e])}var ut={exports:{}},lt={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mt;function fe(){if(Mt)return lt;Mt=1;var t=ce();function e(i,f){return i===f&&(i!==0||1/i===1/f)||i!==i&&f!==f}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,c=t.useEffect,u=t.useLayoutEffect,s=t.useDebugValue;function l(i,f){var h=f(),C=r({inst:{value:h,getSnapshot:f}}),m=C[0].inst,q=C[1];return u(function(){m.value=h,m.getSnapshot=f,p(m)&&q({inst:m})},[i,h,f]),c(function(){return p(m)&&q({inst:m}),i(function(){p(m)&&q({inst:m})})},[i]),s(h),h}function p(i){var f=i.getSnapshot;i=i.value;try{var h=f();return!n(i,h)}catch{return!0}}function b(i,f){return f()}var R=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?b:l;return lt.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:R,lt}var Wt;function de(){return Wt||(Wt=1,ut.exports=fe()),ut.exports}var he=de();const zt=0,Kt=1,Gt=2,Ut=3;var qt=Object.prototype.hasOwnProperty;function gt(t,e){var n,r;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((r=t.length)===e.length)for(;r--&&gt(t[r],e[r]););return r===-1}if(!n||typeof t=="object"){r=0;for(n in t)if(qt.call(t,n)&&++r&&!qt.call(e,n)||!(n in e)||!gt(t[n],e[n]))return!1;return Object.keys(e).length===r}}return t!==t&&e!==e}const j=new WeakMap,W=()=>{},D=W(),St=Object,a=t=>t===D,N=t=>typeof t=="function",U=(t,e)=>({...t,...e}),Jt=t=>N(t.then),ft={},st={},Ct="undefined",Z=typeof window!=Ct,Rt=typeof document!=Ct,me=Z&&"Deno"in window,pe=()=>Z&&typeof window.requestAnimationFrame!=Ct,Yt=(t,e)=>{const n=j.get(t);return[()=>!a(e)&&t.get(e)||ft,r=>{if(!a(e)){const c=t.get(e);e in st||(st[e]=c),n[5](e,U(c,r),c||ft)}},n[6],()=>!a(e)&&e in st?st[e]:!a(e)&&t.get(e)||ft]};let vt=!0;const Ee=()=>vt,[wt,yt]=Z&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[W,W],ge=()=>{const t=Rt&&document.visibilityState;return a(t)||t!=="hidden"},Se=t=>(Rt&&document.addEventListener("visibilitychange",t),wt("focus",t),()=>{Rt&&document.removeEventListener("visibilitychange",t),yt("focus",t)}),Re=t=>{const e=()=>{vt=!0,t()},n=()=>{vt=!1};return wt("online",e),wt("offline",n),()=>{yt("online",e),yt("offline",n)}},ve={isOnline:Ee,isVisible:ge},we={initFocus:Se,initReconnect:Re},$t=!Tt.useId,Q=!Z||me,ye=t=>pe()?window.requestAnimationFrame(t):setTimeout(t,1),dt=Q?w.useEffect:w.useLayoutEffect,ht=typeof navigator<"u"&&navigator.connection,Ht=!Q&&ht&&(["slow-2g","2g"].includes(ht.effectiveType)||ht.saveData),ot=new WeakMap,Oe=t=>St.prototype.toString.call(t),mt=(t,e)=>t===`[object ${e}]`;let De=0;const Ot=t=>{const e=typeof t,n=Oe(t),r=mt(n,"Date"),c=mt(n,"RegExp"),u=mt(n,"Object");let s,l;if(St(t)===t&&!r&&!c){if(s=ot.get(t),s)return s;if(s=++De+"~",ot.set(t,s),Array.isArray(t)){for(s="@",l=0;l<t.length;l++)s+=Ot(t[l])+",";ot.set(t,s)}if(u){s="#";const p=St.keys(t).sort();for(;!a(l=p.pop());)a(t[l])||(s+=l+":"+Ot(t[l])+",");ot.set(t,s)}}else s=r?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return s},bt=t=>{if(N(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?Ot(t):"",[t,e]};let Te=0;const Dt=()=>++Te;async function Xt(...t){const[e,n,r,c]=t,u=U({populateCache:!0,throwOnError:!0},typeof c=="boolean"?{revalidate:c}:c||{});let s=u.populateCache;const l=u.rollbackOnError;let p=u.optimisticData;const b=f=>typeof l=="function"?l(f):l!==!1,R=u.throwOnError;if(N(n)){const f=n,h=[],C=e.keys();for(const m of C)!/^\$(inf|sub)\$/.test(m)&&f(e.get(m)._k)&&h.push(m);return Promise.all(h.map(i))}return i(n);async function i(f){const[h]=bt(f);if(!h)return;const[C,m]=Yt(e,h),[q,o,tt,J]=j.get(e),M=()=>{const T=q[h];return(N(u.revalidate)?u.revalidate(C().data,f):u.revalidate!==!1)&&(delete tt[h],delete J[h],T&&T[0])?T[0](Gt).then(()=>C().data):C().data};if(t.length<3)return M();let O=r,x,L=!1;const S=Dt();o[h]=[S,0];const B=!a(p),V=C(),k=V.data,et=V._c,$=a(et)?k:et;if(B&&(p=N(p)?p($,k):p,m({data:p,_c:$})),N(O))try{O=O($)}catch(T){x=T,L=!0}if(O&&Jt(O))if(O=await O.catch(T=>{x=T,L=!0}),S!==o[h][0]){if(L)throw x;return O}else L&&B&&b(x)&&(s=!0,m({data:$,_c:D}));if(s&&!L)if(N(s)){const T=s(O,$);m({data:T,error:D,_c:D})}else m({data:O,error:D,_c:D});if(o[h][1]=Dt(),Promise.resolve(M()).then(()=>{m({_c:D})}),L){if(R)throw x;return}return O}}const Bt=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},_e=(t,e)=>{if(!j.has(t)){const n=U(we,e),r=Object.create(null),c=Xt.bind(D,t);let u=W;const s=Object.create(null),l=(R,i)=>{const f=s[R]||[];return s[R]=f,f.push(i),()=>f.splice(f.indexOf(i),1)},p=(R,i,f)=>{t.set(R,i);const h=s[R];if(h)for(const C of h)C(i,f)},b=()=>{if(!j.has(t)&&(j.set(t,[r,Object.create(null),Object.create(null),Object.create(null),c,p,l]),!Q)){const R=n.initFocus(setTimeout.bind(D,Bt.bind(D,r,zt))),i=n.initReconnect(setTimeout.bind(D,Bt.bind(D,r,Kt)));u=()=>{R&&R(),i&&i(),j.delete(t)}}};return b(),[t,c,b,u]}return[t,j.get(t)[4]]},Ce=(t,e,n,r,c)=>{const u=n.errorRetryCount,s=c.retryCount,l=~~((Math.random()+.5)*(1<<(s<8?s:8)))*n.errorRetryInterval;!a(u)&&s>u||setTimeout(r,l,c)},be=gt,[Qt,Ie]=_e(new Map),Ae=U({onLoadingSlow:W,onSuccess:W,onError:W,onErrorRetry:Ce,onDiscarded:W,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:Ht?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:Ht?5e3:3e3,compare:be,isPaused:()=>!1,cache:Qt,mutate:Ie,fallback:{}},ve),Le=(t,e)=>{const n=U(t,e);if(e){const{use:r,fallback:c}=t,{use:u,fallback:s}=e;r&&u&&(n.use=r.concat(u)),c&&s&&(n.fallback=U(c,s))}return n},Ve=w.createContext({}),Ne="$inf$",Zt=Z&&window.__SWR_DEVTOOLS_USE__,xe=Zt?window.__SWR_DEVTOOLS_USE__:[],Pe=()=>{Zt&&(window.__SWR_DEVTOOLS_REACT__=Tt)},te=t=>N(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],Fe=()=>{const t=w.useContext(Ve);return w.useMemo(()=>U(Ae,t),[t])},je=t=>(e,n,r)=>t(e,n&&((...u)=>{const[s]=bt(e),[,,,l]=j.get(Qt);if(s.startsWith(Ne))return n(...u);const p=l[s];return a(p)?n(...u):(delete l[s],p)}),r),Me=xe.concat(je),We=t=>function(...n){const r=Fe(),[c,u,s]=te(n),l=Le(r,s);let p=t;const{use:b}=l,R=(b||[]).concat(Me);for(let i=R.length;i--;)p=R[i](p);return p(c,u||l.fetcher||null,l)},Ue=(t,e,n)=>{const r=e[t]||(e[t]=[]);return r.push(n),()=>{const c=r.indexOf(n);c>=0&&(r[c]=r[r.length-1],r.pop())}},qe=(t,e)=>(...n)=>{const[r,c,u]=te(n),s=(u.use||[]).concat(e);return t(r,c,{...u,use:s})};Pe();const pt=Tt.use||(t=>{switch(t.status){case"pending":throw t;case"fulfilled":return t.value;case"rejected":throw t.reason;default:throw t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t}}),Et={dedupe:!0},kt=Promise.resolve(D),$e=(t,e,n)=>{const{cache:r,compare:c,suspense:u,fallbackData:s,revalidateOnMount:l,revalidateIfStale:p,refreshInterval:b,refreshWhenHidden:R,refreshWhenOffline:i,keepPreviousData:f}=n,[h,C,m,q]=j.get(r),[o,tt]=bt(t),J=w.useRef(!1),M=w.useRef(!1),O=w.useRef(o),x=w.useRef(e),L=w.useRef(n),S=()=>L.current,B=()=>S().isVisible()&&S().isOnline(),[V,k,et,$]=Yt(r,o),T=w.useRef({}).current,Y=a(s)?a(n.fallback)?D:n.fallback[o]:s,It=(d,g)=>{for(const v in T){const E=v;if(E==="data"){if(!c(d[E],g[E])&&(!a(d[E])||!c(rt,g[E])))return!1}else if(g[E]!==d[E])return!1}return!0},At=w.useMemo(()=>{const d=!o||!e?!1:a(l)?S().isPaused()||u?!1:p!==!1:l,g=_=>{const P=U(_);return delete P._k,d?{isValidating:!0,isLoading:!0,...P}:P},v=V(),E=$(),A=g(v),G=v===E?A:g(E);let y=A;return[()=>{const _=g(V());return It(_,y)?(y.data=_.data,y.isLoading=_.isLoading,y.isValidating=_.isValidating,y.error=_.error,y):(y=_,_)},()=>G]},[r,o]),z=he.useSyncExternalStore(w.useCallback(d=>et(o,(g,v)=>{It(v,g)||d()}),[r,o]),At[0],At[1]),Lt=!J.current,ee=h[o]&&h[o].length>0,K=z.data,H=a(K)?Y&&Jt(Y)?pt(Y):Y:K,nt=z.error,it=w.useRef(H),rt=f?a(K)?a(it.current)?H:it.current:K:H,Vt=ee&&!a(nt)?!1:Lt&&!a(l)?l:S().isPaused()?!1:u?a(H)?!1:p:a(H)||p,Nt=!!(o&&e&&Lt&&Vt),ne=a(z.isValidating)?Nt:z.isValidating,re=a(z.isLoading)?Nt:z.isLoading,X=w.useCallback(async d=>{const g=x.current;if(!o||!g||M.current||S().isPaused())return!1;let v,E,A=!0;const G=d||{},y=!m[o]||!G.dedupe,_=()=>$t?!M.current&&o===O.current&&J.current:o===O.current,P={isValidating:!1,isLoading:!1},Pt=()=>{k(P)},Ft=()=>{const I=m[o];I&&I[1]===E&&delete m[o]},jt={isValidating:!0};a(V().data)&&(jt.isLoading=!0);try{if(y&&(k(jt),n.loadingTimeout&&a(V().data)&&setTimeout(()=>{A&&_()&&S().onLoadingSlow(o,n)},n.loadingTimeout),m[o]=[g(tt),Dt()]),[v,E]=m[o],v=await v,y&&setTimeout(Ft,n.dedupingInterval),!m[o]||m[o][1]!==E)return y&&_()&&S().onDiscarded(o),!1;P.error=D;const I=C[o];if(!a(I)&&(E<=I[0]||E<=I[1]||I[1]===0))return Pt(),y&&_()&&S().onDiscarded(o),!1;const F=V().data;P.data=c(F,v)?F:v,y&&_()&&S().onSuccess(v,o,n)}catch(I){Ft();const F=S(),{shouldRetryOnError:at}=F;F.isPaused()||(P.error=I,y&&_()&&(F.onError(I,o,F),(at===!0||N(at)&&at(I))&&(!S().revalidateOnFocus||!S().revalidateOnReconnect||B())&&F.onErrorRetry(I,o,F,se=>{const ct=h[o];ct&&ct[0]&&ct[0](Ut,se)},{retryCount:(G.retryCount||0)+1,dedupe:!0})))}return A=!1,Pt(),!0},[o,r]),xt=w.useCallback((...d)=>Xt(r,O.current,...d),[]);if(dt(()=>{x.current=e,L.current=n,a(K)||(it.current=K)}),dt(()=>{if(!o)return;const d=X.bind(D,Et);let g=0;S().revalidateOnFocus&&(g=Date.now()+S().focusThrottleInterval);const E=Ue(o,h,(A,G={})=>{if(A==zt){const y=Date.now();S().revalidateOnFocus&&y>g&&B()&&(g=y+S().focusThrottleInterval,d())}else if(A==Kt)S().revalidateOnReconnect&&B()&&d();else{if(A==Gt)return X();if(A==Ut)return X(G)}});return M.current=!1,O.current=o,J.current=!0,k({_k:tt}),Vt&&(m[o]||(a(H)||Q?d():ye(d))),()=>{M.current=!0,E()}},[o]),dt(()=>{let d;function g(){const E=N(b)?b(V().data):b;E&&d!==-1&&(d=setTimeout(v,E))}function v(){!V().error&&(R||S().isVisible())&&(i||S().isOnline())?X(Et).then(g):g()}return g(),()=>{d&&(clearTimeout(d),d=-1)}},[b,R,i,o]),w.useDebugValue(rt),u){const d=o&&a(H);if(!$t&&Q&&d)throw new Error("Fallback data is required when using Suspense in SSR.");d&&(x.current=e,L.current=n,M.current=!1);const g=q[o],v=!a(g)&&d?xt(g):kt;if(pt(v),!a(nt)&&d)throw nt;const E=d?X(Et):kt;!a(rt)&&d&&(E.status="fulfilled",E.value=!0),pt(E)}return{mutate:xt,get data(){return T.data=!0,rt},get error(){return T.error=!0,nt},get isValidating(){return T.isValidating=!0,ne},get isLoading(){return T.isLoading=!0,re}}},He=We($e),Be=t=>(e,n,r)=>(r.revalidateOnFocus=!1,r.revalidateIfStale=!1,r.revalidateOnReconnect=!1,t(e,n,r)),ke=qe(He,Be);async function ze(t){return t.arrayBuffer().then(e=>_t(new Uint8Array(e)))}function Ke(t){return`/music/songs/${t}`}function Ge(t){const e=ae(t);return _t(e)}async function Je(t,e){if(e==="builtin"){const n=Ke(t);return fetch(n).then(ze)}else{if(e==="base64")return Ge(t);if(e==="local")return await ue(),le(t).then(n=>n?.getFile()).then(n=>{if(!n)throw new Error(`Could not get song for ${t}, ${e}`);return n.arrayBuffer()}).then(n=>_t(new Uint8Array(n)))}return Promise.reject(new Error(`Could not get song for ${t}, ${e}`))}function en(t,e){return ke([t,e],([n,r])=>Je(n,r))}export{en as a,tn as u};
