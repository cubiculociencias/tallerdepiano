import{a as g,p as e,L,w as z}from"./chunk-PVWAREVJ-BeAWct5i.js";import{A as E,M as T}from"./MarketingFooter-CHKr6wB6.js";import{M as k,C as I,R as W}from"./AdjustInstruments-2T0166Fg.js";import{c as j,u as C}from"./Dropdown-B9h-t97s.js";import{n as M,u as H,c as f,j as v,o as V}from"./context-kPolJz0x.js";import{S as p,i as B,s as R,a as U,b as D,c as q,l as O,d as Z,r as G}from"./Canvas-C5qiJpk2.js";import{C as J,a as K}from"./library--ia92sxe.js";import{u as Q}from"./index-DcBgwC9u.js";import{S as X}from"./SongScrubBar-Bi4bL6LF.js";import{P as Y}from"./PreviewIcon-BzqQjxfP.js";import{S as ee}from"./SongPreview-C2g1F6yc.js";import"./SongVisualizer-BApS7ggG.js";import"./common-wRUDMAM3.js";import"./manifest-DPsq83CE.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],S=j("folder",se);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],re=j("music",te);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],P=j("plus",ae);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ne=j("search",oe);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ie=j("trash-2",le);function ce(){const[s,t]=g.useState(M.md);return g.useEffect(()=>{const r=window.innerWidth;t(r);const n=()=>t(window.innerWidth);return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}},[]),s}function de({show:s=!0,onClose:t=()=>{},songMeta:r=void 0}){const{title:n,id:o,source:a}=r??{},l=H(),d=Q();C("keydown",m=>{s&&m.key===" "&&(m.preventDefault(),l.toggle())});function x(){return l.stop(),t()}return!s||!o||!a?null:e.jsx(k,{show:s&&!!o,onClose:x,className:"min-w-[min(100%,600px)]",children:e.jsxs("div",{className:"flex flex-col gap-3 p-8",children:[e.jsx("div",{className:"flex w-full flex-col whitespace-nowrap",children:e.jsx("span",{className:"text-xl font-semibold",children:n})}),e.jsxs("div",{className:"flex grow flex-col overflow-hidden rounded-md",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"pointer-events-none absolute z-20 h-full w-full rounded-md"}),e.jsx(X,{height:30})]}),e.jsxs("div",{style:{position:"relative",backgroundColor:"#2e2e2e",height:340,minHeight:340,width:"100%",overflow:"hidden"},onClick:()=>l.toggle(),children:[e.jsx(Y,{isLoading:!d.canPlay,isPlaying:d.playing,onPlay:m=>{m.stopPropagation(),l.play()}}),o&&a&&e.jsx(ee,{songId:o,source:a})]}),e.jsx(p,{height:16}),e.jsx(L,{to:`/play?id=${o}&source=${a}`,className:"bg-purple-primary hover:bg-purple-hover flex h-10 w-full items-center justify-center rounded-md border-none text-xl text-white transition",children:"Play Now"})]})]})})}function me({columns:s,sortCol:t,onSelectCol:r,rowHeight:n}){return e.jsx(e.Fragment,{children:s.map((o,a)=>{const l=Math.abs(t)===a+1;return e.jsx("div",{className:f("select-none","sticky top-0 z-10 flex items-center bg-violet-900 text-white",`h-[${n}px]`),children:e.jsxs("span",{className:f("flex cursor-pointer items-center gap-1",a===0&&"ml-5"),onClick:()=>r(a+1),children:[o.label,l&&e.jsx(I,{className:f("relative top-[1px]",t<0&&"rotate-180")})]})},`col-${o.id.toString()}`)})})}function xe(s,t){return typeof s=="string"?s.localeCompare(t+""):+s-+t}function he(s,t,r){return r.sort((n,o)=>(t?-1:1)*xe(s(n),s(o)))}function pe({columns:s,rows:t,search:r,onSelectRow:n,filter:o,getId:a}){const[l,d]=g.useState(1),x=ce()<M.sm;let m=50;x&&(s=s.filter(i=>i.keep));const y=i=>{d(l===i?-i:i)},c=(i="")=>!r||String(i).toUpperCase().includes(r.toUpperCase()),F=r?t.filter(i=>o.some(h=>c(i[h]))):t,A=s[Math.abs(l)-1].id,w=he(i=>{let h=i[A];return typeof h=="string"||typeof h=="number"?h:0},l<0,F),b=`repeat(${s.length}, 1fr)`;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid",style:{gridTemplateColumns:b},children:e.jsx(me,{columns:s,sortCol:l,onSelectCol:y,rowHeight:m})}),e.jsx("div",{className:"relative flex min-h-64 grow",children:e.jsxs("div",{className:"absolute grid h-full w-full content-start overflow-y-scroll rounded-md bg-white shadow-md",style:{gridTemplateColumns:b},children:[w.length===0&&e.jsx("h2",{className:"p-5 text-2xl",children:"No results"}),w.map((i,h)=>e.jsx("div",{className:"group contents cursor-pointer",onClick:u=>{u.stopPropagation(),n(a(i))},children:s.map((u,N)=>{let _=u.format?u.format(i[u.id]):i[u.id];const $=N===0?20:0;return e.jsx("span",{className:"relative flex shrink-0 items-center px-3 text-sm group-even:bg-gray-100 group-hover:bg-violet-200",style:{paddingLeft:$,height:m},children:_},`row-${h}-col-${N}`)})},`row-${a(i)}`))]})})]})}function ue({onClose:s}){const t=v(q),r=v(O),n=v(Z),o=v(G);return B()?e.jsxs("div",{className:"mx-auto w-[min(100vw,500px)] bg-white p-4",children:[e.jsxs("div",{className:"mb-6 border-b border-gray-200 pb-4",children:[e.jsx("h2",{className:"mb-1 text-lg font-medium text-gray-900",children:"Folder Management"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Organize your music collection"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:R,disabled:t!==!1,className:"flex items-center justify-center gap-2 rounded-md border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 transition-colors hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx(W,{className:`h-4 w-4 ${t?"animate-spin":""}`}),"Scan Folders"]}),e.jsxs("button",{onClick:U,className:"flex flex-4 items-center justify-center gap-2 rounded-md bg-black px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-gray-800",children:[e.jsx(P,{className:"h-4 w-4"}),"Add Folder"]})]}),e.jsx(p,{height:24}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"mb-3 flex flex-col justify-between gap-1",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700",children:["Folders (",r.length,")"]}),o&&e.jsx("p",{className:"text-xs text-red-800",children:"Please rescan folders to grant access to your music files."})]}),r.length===0?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(S,{className:"mx-auto mb-3 h-12 w-12 text-gray-300"}),e.jsx("p",{className:"text-sm text-gray-500",children:"No folders added yet"}),e.jsx("p",{className:"mt-1 text-xs text-gray-400",children:"Add a folder to get started"})]}):e.jsx("div",{className:"space-y-1",children:r.map((a,l)=>{const d=n.get(a.id)?.length||0;return e.jsxs("div",{className:"group flex items-center justify-between rounded-md border border-gray-200 p-3 transition-colors hover:border-gray-300 hover:bg-gray-50",children:[e.jsxs("div",{className:"flex min-w-0 flex-1 items-center gap-3",children:[e.jsx(S,{className:"h-4 w-4 flex-shrink-0 text-gray-400"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate text-sm font-medium text-gray-900",children:a.handle.name}),e.jsxs("div",{className:"mt-1 flex items-center gap-1",children:[e.jsx(re,{className:"h-3 w-3 text-gray-400"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[d," ",d===1?"song":"songs"]})]})]})]}),e.jsx("button",{onClick:x=>{x.stopPropagation(),D(a.id)},className:"rounded p-1.5 text-gray-400 opacity-0 transition-colors group-hover:opacity-100 hover:bg-red-50 hover:text-red-500",title:"Remove folder",children:e.jsx(ie,{className:"h-4 w-4"})})]},l)})})]}),r.length>0&&e.jsx("div",{className:"mt-6 border-t border-gray-200 pt-4",children:e.jsxs("p",{className:"text-center text-xs text-gray-500",children:["Total:"," ",r.reduce((a,l)=>a+(n.get(l.id)?.length??0),0)," ","songs across ",r.length," folders"]})})]}):e.jsxs("div",{className:"relative flex w-[min(100vw,500px)] flex-col gap-5 p-8 text-base",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Add Music Folder"}),e.jsx(p,{height:0}),e.jsxs("div",{className:"flex items-center gap-3 rounded-md border border-red-300 bg-red-50 p-4 text-red-700",children:[e.jsx(J,{size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Browser Not Supported"}),e.jsx("p",{className:"text-sm",children:"Syncing folders is only supported in Chromium-based browsers like Chrome and Edge due to lack of support for the File System Access API. Please switch to a supported browser."})]})]}),e.jsx("button",{onClick:s,className:"w-full cursor-pointer rounded-md bg-gray-500 py-2 text-white transition hover:bg-gray-600",children:"Close"})]})}function ge(s){const{onChange:t,name:r,className:n,error:o,type:a,placeholder:l}=s;return e.jsx("input",{type:a,name:r,onChange:t,className:f(n,"rounded-md p-2 text-base shadow-[inset_0px_1px_4px_rgba(0,0,0,0.25)]",o&&"outline outline-red-600"),placeholder:l})}function fe({onSearch:s,placeholder:t}){return e.jsxs("div",{className:"relative h-[40px] w-80",children:[e.jsx(ge,{type:"search",onChange:r=>s(r.target.value),className:"absolute h-full w-full rounded-md bg-gray-100 pl-10 placeholder-gray-700 placeholder:text-base",placeholder:t}),e.jsx(ne,{size:20,className:"absolute top-1/2 left-3 -translate-y-1/2"})]})}const $e=z(function(){let t=K();const[r,n]=g.useState(!1),[o,a]=g.useState(""),l=t.find(c=>c.id===o),[d,x]=g.useState("");C("keydown",c=>{c.key==="Escape"&&n(!1)});const m=c=>{n(!0),c.stopPropagation()},y=()=>{n(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:"Select a song"}),e.jsx(de,{show:!!o,songMeta:l,onClose:()=>{a(null)}}),e.jsx(k,{show:r,onClose:y,children:e.jsx(ue,{onClose:y})}),e.jsxs("div",{className:"bg-purple-lightest flex min-h-screen w-full flex-col",children:[e.jsx(E,{}),e.jsxs("div",{className:"mx-auto flex w-full max-w-(--breakpoint-lg) grow flex-col p-6",children:[e.jsx("h2",{className:"text-3xl",children:"Learn a song"}),e.jsx(p,{height:8}),e.jsx("h3",{className:"text-base",children:" Select a song, choose your settings, and begin learning"}),e.jsx(p,{height:24}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(fe,{placeholder:"Search Songs by Title or Artist",onSearch:x}),e.jsxs("button",{className:f("hidden flex-nowrap whitespace-nowrap sm:flex","items-center gap-1 rounded-md px-4 py-2","bg-purple-dark hover:bg-purple-hover text-white transition"),onClick:m,children:[e.jsx(P,{width:20,height:20}),e.jsx("span",{children:"Manage Folders"})]})]}),e.jsx(p,{height:32}),e.jsx(pe,{columns:[{label:"Name",id:"title",keep:!0},{label:"Length",id:"duration",format:c=>V(Number(c))}],getId:c=>c.id,rows:t,filter:["title"],onSelectRow:a,search:d})]}),e.jsx(p,{height:32})]}),e.jsx(T,{})]})});export{$e as default};
