import{R as zt,a as L,A as lr,p as ur}from"./chunk-PVWAREVJ-BeAWct5i.js";const me={},We=(e,t)=>e.unstable_is?e.unstable_is(t):t===e,$e=e=>"init"in e,Be=e=>!!e.write,Je=e=>"v"in e||"e"in e,ge=e=>{if("e"in e)throw e.e;if((me?"production":void 0)!=="production"&&!("v"in e))throw new Error("[Bug] atom state is not initialized");return e.v},Ne=new WeakMap,ut=e=>{var t;return Ae(e)&&!!((t=Ne.get(e))!=null&&t[0])},dr=e=>{const t=Ne.get(e);t?.[0]&&(t[0]=!1,t[1].forEach(n=>n()))},Vt=(e,t)=>{let n=Ne.get(e);if(!n){n=[!0,new Set],Ne.set(e,n);const s=()=>{n[0]=!1};e.then(s,s)}n[1].add(t)},Ae=e=>typeof e?.then=="function",jt=(e,t,n)=>{n.p.has(e)||(n.p.add(e),t.then(()=>{n.p.delete(e)},()=>{n.p.delete(e)}))},Ce=(e,t,n)=>{const s=n(e),i="v"in s,r=s.v;if(Ae(t))for(const o of s.d.keys())jt(e,t,n(o));s.v=t,delete s.e,(!i||!Object.is(r,s.v))&&(++s.n,Ae(r)&&dr(r))},dt=(e,t,n)=>{var s;const i=new Set;for(const r of((s=n.get(e))==null?void 0:s.t)||[])n.has(r)&&i.add(r);for(const r of t.p)i.add(r);return i},fr=()=>{const e=new Set,t=()=>{e.forEach(n=>n())};return t.add=n=>(e.add(n),()=>{e.delete(n)}),t},Oe=()=>{const e={},t=new WeakMap,n=s=>{var i,r;(i=t.get(e))==null||i.forEach(o=>o(s)),(r=t.get(s))==null||r.forEach(o=>o())};return n.add=(s,i)=>{const r=s||e,o=(t.has(r)?t:t.set(r,new Set)).get(r);return o.add(i),()=>{o?.delete(i),o.size||t.delete(r)}},n},hr=e=>(e.c||(e.c=Oe()),e.m||(e.m=Oe()),e.u||(e.u=Oe()),e.f||(e.f=fr()),e),Lt=Symbol(),pr=e=>e[Lt],mr=(e=new WeakMap,t=new WeakMap,n=new WeakMap,s=new Set,i=new Set,r=new Set,o={},u=(h,...f)=>h.read(...f),c=(h,...f)=>h.write(...f),l=(h,f)=>{var w;return(w=h.unstable_onInit)==null?void 0:w.call(h,f)},a=(h,f)=>{var w;return(w=h.onMount)==null?void 0:w.call(h,f)},...d)=>{const h=d[0]||(g=>{if((me?"production":void 0)!=="production"&&!g)throw new Error("Atom is undefined or null");let b=e.get(g);return b||(b={d:new Map,p:new Set,n:0},e.set(g,b),l?.(g,E)),b}),f=d[1]||(()=>{const g=[],b=_=>{try{_()}catch(N){g.push(N)}};do{o.f&&b(o.f);const _=new Set,N=_.add.bind(_);s.forEach(M=>{var C;return(C=t.get(M))==null?void 0:C.l.forEach(N)}),s.clear(),r.forEach(N),r.clear(),i.forEach(N),i.clear(),_.forEach(b),s.size&&w()}while(s.size||r.size||i.size);if(g.length)throw new AggregateError(g)}),w=d[2]||(()=>{const g=[],b=new WeakSet,_=new WeakSet,N=Array.from(s);for(;N.length;){const M=N[N.length-1],C=h(M);if(_.has(M)){N.pop();continue}if(b.has(M)){if(n.get(M)===C.n)g.push([M,C]);else if((me?"production":void 0)!=="production"&&n.has(M))throw new Error("[Bug] invalidated atom exists");_.add(M),N.pop();continue}b.add(M);for(const U of dt(M,C,t))b.has(U)||N.push(U)}for(let M=g.length-1;M>=0;--M){const[C,U]=g[M];let O=!1;for(const z of U.d.keys())if(z!==C&&s.has(z)){O=!0;break}O&&(I(C),x(C)),n.delete(C)}}),I=d[3]||(g=>{var b;const _=h(g);if(Je(_)&&(t.has(g)&&n.get(g)!==_.n||Array.from(_.d).every(([F,T])=>I(F).n===T)))return _;_.d.clear();let N=!0;const M=()=>{t.has(g)&&(x(g),w(),f())},C=F=>{var T;if(We(g,F)){const oe=h(F);if(!Je(oe))if($e(F))Ce(F,F.init,h);else throw new Error("no atom init");return ge(oe)}const Y=I(F);try{return ge(Y)}finally{_.d.set(F,Y.n),ut(_.v)&&jt(g,_.v,Y),(T=t.get(F))==null||T.t.add(g),N||M()}};let U,O;const z={get signal(){return U||(U=new AbortController),U.signal},get setSelf(){return(me?"production":void 0)!=="production"&&!Be(g)&&console.warn("setSelf function cannot be used with read-only atom"),!O&&Be(g)&&(O=(...F)=>{if((me?"production":void 0)!=="production"&&N&&console.warn("setSelf function cannot be called in sync"),!N)try{return p(g,...F)}finally{w(),f()}}),O}},V=_.n;try{const F=u(g,C,z);return Ce(g,F,h),Ae(F)&&(Vt(F,()=>U?.abort()),F.then(M,M)),_}catch(F){return delete _.v,_.e=F,++_.n,_}finally{N=!1,V!==_.n&&n.get(g)===V&&(n.set(g,_.n),s.add(g),(b=o.c)==null||b.call(o,g))}}),y=d[4]||(g=>{const b=[g];for(;b.length;){const _=b.pop(),N=h(_);for(const M of dt(_,N,t)){const C=h(M);n.set(M,C.n),b.push(M)}}}),p=d[5]||((g,...b)=>{let _=!0;const N=C=>ge(I(C)),M=(C,...U)=>{var O;const z=h(C);try{if(We(g,C)){if(!$e(C))throw new Error("atom not writable");const V=z.n,F=U[0];Ce(C,F,h),x(C),V!==z.n&&(s.add(C),(O=o.c)==null||O.call(o,C),y(C));return}else return p(C,...U)}finally{_||(w(),f())}};try{return c(g,N,M,...b)}finally{_=!1}}),x=d[6]||(g=>{var b;const _=h(g),N=t.get(g);if(N&&!ut(_.v)){for(const[M,C]of _.d)if(!N.d.has(M)){const U=h(M);S(M).t.add(g),N.d.add(M),C!==U.n&&(s.add(M),(b=o.c)==null||b.call(o,M),y(M))}for(const M of N.d||[])if(!_.d.has(M)){N.d.delete(M);const C=m(M);C?.t.delete(g)}}}),S=d[7]||(g=>{var b;const _=h(g);let N=t.get(g);if(!N){I(g);for(const M of _.d.keys())S(M).t.add(g);if(N={l:new Set,d:new Set(_.d.keys()),t:new Set},t.set(g,N),(b=o.m)==null||b.call(o,g),Be(g)){const M=()=>{let C=!0;const U=(...O)=>{try{return p(g,...O)}finally{C||(w(),f())}};try{const O=a(g,U);O&&(N.u=()=>{C=!0;try{O()}finally{C=!1}})}finally{C=!1}};i.add(M)}}return N}),m=d[8]||(g=>{var b;const _=h(g);let N=t.get(g);if(N&&!N.l.size&&!Array.from(N.t).some(M=>{var C;return(C=t.get(M))==null?void 0:C.d.has(g)})){N.u&&r.add(N.u),N=void 0,t.delete(g),(b=o.u)==null||b.call(o,g);for(const M of _.d.keys()){const C=m(M);C?.t.delete(g)}return}return N}),P=[e,t,n,s,i,r,o,u,c,l,a,h,f,w,I,y,p,x,S,m],E={get:g=>ge(I(g)),set:(g,...b)=>{try{return p(g,...b)}finally{w(),f()}},sub:(g,b)=>{const N=S(g).l;return N.add(b),f(),()=>{N.delete(b),m(g),f()}}};return Object.defineProperty(E,Lt,{value:P}),E},gr=mr,Qn=pr,Xn=hr,Yn=We,Zn=$e,es=Je,ts=ge,ft=Vt,rs=Ce,qt={};let br=0;function B(e,t){const n=`atom${++br}`,s={toString(){return(qt?"production":void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof e=="function"?s.read=e:(s.init=e,s.read=yr,s.write=vr),s}function yr(e){return e(this)}function vr(e,t,n){return t(this,typeof n=="function"?n(e(this)):n)}function kr(){return gr()}let ae;function Wt(){return ae||(ae=kr(),(qt?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=ae),globalThis.__JOTAI_DEFAULT_STORE__!==ae&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),ae}const wr={},xr=L.createContext(void 0);function rt(e){const t=L.useContext(xr);return e?.store||t||Wt()}const Ke=e=>typeof e?.then=="function",He=e=>{e.status||(e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}))},Ir=zt.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(He(e),e)}),De=new WeakMap,ht=(e,t)=>{let n=De.get(e);return n||(n=new Promise((s,i)=>{let r=e;const o=l=>a=>{r===l&&s(a)},u=l=>a=>{r===l&&i(a)},c=()=>{try{const l=t();Ke(l)?(De.set(l,n),r=l,l.then(o(l),u(l)),ft(l,c)):s(l)}catch(l){i(l)}};e.then(o(e),u(e)),ft(e,c)}),De.set(e,n)),n};function Sr(e,t){const{delay:n,unstable_promiseStatus:s=!zt.use}=t||{},i=rt(t),[[r,o,u],c]=L.useReducer(a=>{const d=i.get(e);return Object.is(a[0],d)&&a[1]===i&&a[2]===e?a:[d,i,e]},void 0,()=>[i.get(e),i,e]);let l=r;if((o!==i||u!==e)&&(c(),l=i.get(e)),L.useEffect(()=>{const a=i.sub(e,()=>{if(s)try{const d=i.get(e);Ke(d)&&He(ht(d,()=>i.get(e)))}catch{}if(typeof n=="number"){setTimeout(c,n);return}c()});return c(),a},[i,e,n,s]),L.useDebugValue(l),Ke(l)){const a=ht(l,()=>i.get(e));return s&&He(a),Ir(a)}return l}function _r(e,t){const n=rt(t);return L.useCallback((...i)=>{if((wr?"production":void 0)!=="production"&&!("write"in e))throw new Error("not writable atom");return n.set(e,...i)},[n,e])}function ns(e,t){return[Sr(e,t),_r(e,t)]}function $t(e){var t,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=$t(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function Tr(){for(var e,t,n=0,s="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=$t(e))&&(s&&(s+=" "),s+=t);return s}const nt="-",Cr=e=>{const t=Nr(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:o=>{const u=o.split(nt);return u[0]===""&&u.length!==1&&u.shift(),Jt(u,t)||Mr(o)},getConflictingClassGroupIds:(o,u)=>{const c=n[o]||[];return u&&s[o]?[...c,...s[o]]:c}}},Jt=(e,t)=>{if(e.length===0)return t.classGroupId;const n=e[0],s=t.nextPart.get(n),i=s?Jt(e.slice(1),s):void 0;if(i)return i;if(t.validators.length===0)return;const r=e.join(nt);return t.validators.find(({validator:o})=>o(r))?.classGroupId},pt=/^\[(.+)\]$/,Mr=e=>{if(pt.test(e)){const t=pt.exec(e)[1],n=t?.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},Nr=e=>{const{theme:t,classGroups:n}=e,s={nextPart:new Map,validators:[]};for(const i in n)Qe(n[i],s,i,t);return s},Qe=(e,t,n,s)=>{e.forEach(i=>{if(typeof i=="string"){const r=i===""?t:mt(t,i);r.classGroupId=n;return}if(typeof i=="function"){if(Ar(i)){Qe(i(s),t,n,s);return}t.validators.push({validator:i,classGroupId:n});return}Object.entries(i).forEach(([r,o])=>{Qe(o,mt(t,r),n,s)})})},mt=(e,t)=>{let n=e;return t.split(nt).forEach(s=>{n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n},Ar=e=>e.isThemeGetter,Pr=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,s=new Map;const i=(r,o)=>{n.set(r,o),t++,t>e&&(t=0,s=n,n=new Map)};return{get(r){let o=n.get(r);if(o!==void 0)return o;if((o=s.get(r))!==void 0)return i(r,o),o},set(r,o){n.has(r)?n.set(r,o):i(r,o)}}},Xe="!",Ye=":",Fr=Ye.length,Er=e=>{const{prefix:t,experimentalParseClassName:n}=e;let s=i=>{const r=[];let o=0,u=0,c=0,l;for(let w=0;w<i.length;w++){let I=i[w];if(o===0&&u===0){if(I===Ye){r.push(i.slice(c,w)),c=w+Fr;continue}if(I==="/"){l=w;continue}}I==="["?o++:I==="]"?o--:I==="("?u++:I===")"&&u--}const a=r.length===0?i:i.substring(c),d=Ur(a),h=d!==a,f=l&&l>c?l-c:void 0;return{modifiers:r,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:f}};if(t){const i=t+Ye,r=s;s=o=>o.startsWith(i)?r(o.substring(i.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(n){const i=s;s=r=>n({className:r,parseClassName:i})}return s},Ur=e=>e.endsWith(Xe)?e.substring(0,e.length-1):e.startsWith(Xe)?e.substring(1):e,Br=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(s=>[s,!0]));return s=>{if(s.length<=1)return s;const i=[];let r=[];return s.forEach(o=>{o[0]==="["||t[o]?(i.push(...r.sort(),o),r=[]):r.push(o)}),i.push(...r.sort()),i}},Or=e=>({cache:Pr(e.cacheSize),parseClassName:Er(e),sortModifiers:Br(e),...Cr(e)}),Dr=/\s+/,Gr=(e,t)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:i,sortModifiers:r}=t,o=[],u=e.trim().split(Dr);let c="";for(let l=u.length-1;l>=0;l-=1){const a=u[l],{isExternal:d,modifiers:h,hasImportantModifier:f,baseClassName:w,maybePostfixModifierPosition:I}=n(a);if(d){c=a+(c.length>0?" "+c:c);continue}let y=!!I,p=s(y?w.substring(0,I):w);if(!p){if(!y){c=a+(c.length>0?" "+c:c);continue}if(p=s(w),!p){c=a+(c.length>0?" "+c:c);continue}y=!1}const x=r(h).join(":"),S=f?x+Xe:x,m=S+p;if(o.includes(m))continue;o.push(m);const P=i(p,y);for(let E=0;E<P.length;++E){const g=P[E];o.push(S+g)}c=a+(c.length>0?" "+c:c)}return c};function Rr(){let e=0,t,n,s="";for(;e<arguments.length;)(t=arguments[e++])&&(n=Kt(t))&&(s&&(s+=" "),s+=n);return s}const Kt=e=>{if(typeof e=="string")return e;let t,n="";for(let s=0;s<e.length;s++)e[s]&&(t=Kt(e[s]))&&(n&&(n+=" "),n+=t);return n};function zr(e,...t){let n,s,i,r=o;function o(c){const l=t.reduce((a,d)=>d(a),e());return n=Or(l),s=n.cache.get,i=n.cache.set,r=u,u(c)}function u(c){const l=s(c);if(l)return l;const a=Gr(c,n);return i(c,a),a}return function(){return r(Rr.apply(null,arguments))}}const D=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},Ht=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Qt=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Vr=/^\d+\/\d+$/,jr=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Lr=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,qr=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Wr=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,$r=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Z=e=>Vr.test(e),A=e=>!!e&&!Number.isNaN(Number(e)),$=e=>!!e&&Number.isInteger(Number(e)),Ge=e=>e.endsWith("%")&&A(e.slice(0,-1)),q=e=>jr.test(e),Jr=()=>!0,Kr=e=>Lr.test(e)&&!qr.test(e),Xt=()=>!1,Hr=e=>Wr.test(e),Qr=e=>$r.test(e),Xr=e=>!v(e)&&!k(e),Yr=e=>ne(e,er,Xt),v=e=>Ht.test(e),K=e=>ne(e,tr,Kr),Re=e=>ne(e,nn,A),gt=e=>ne(e,Yt,Xt),Zr=e=>ne(e,Zt,Qr),xe=e=>ne(e,rr,Hr),k=e=>Qt.test(e),ce=e=>se(e,tr),en=e=>se(e,sn),bt=e=>se(e,Yt),tn=e=>se(e,er),rn=e=>se(e,Zt),Ie=e=>se(e,rr,!0),ne=(e,t,n)=>{const s=Ht.exec(e);return s?s[1]?t(s[1]):n(s[2]):!1},se=(e,t,n=!1)=>{const s=Qt.exec(e);return s?s[1]?t(s[1]):n:!1},Yt=e=>e==="position"||e==="percentage",Zt=e=>e==="image"||e==="url",er=e=>e==="length"||e==="size"||e==="bg-size",tr=e=>e==="length",nn=e=>e==="number",sn=e=>e==="family-name",rr=e=>e==="shadow",on=()=>{const e=D("color"),t=D("font"),n=D("text"),s=D("font-weight"),i=D("tracking"),r=D("leading"),o=D("breakpoint"),u=D("container"),c=D("spacing"),l=D("radius"),a=D("shadow"),d=D("inset-shadow"),h=D("text-shadow"),f=D("drop-shadow"),w=D("blur"),I=D("perspective"),y=D("aspect"),p=D("ease"),x=D("animate"),S=()=>["auto","avoid","all","avoid-page","page","left","right","column"],m=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],P=()=>[...m(),k,v],E=()=>["auto","hidden","clip","visible","scroll"],g=()=>["auto","contain","none"],b=()=>[k,v,c],_=()=>[Z,"full","auto",...b()],N=()=>[$,"none","subgrid",k,v],M=()=>["auto",{span:["full",$,k,v]},$,k,v],C=()=>[$,"auto",k,v],U=()=>["auto","min","max","fr",k,v],O=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],z=()=>["start","end","center","stretch","center-safe","end-safe"],V=()=>["auto",...b()],F=()=>[Z,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...b()],T=()=>[e,k,v],Y=()=>[...m(),bt,gt,{position:[k,v]}],oe=()=>["no-repeat",{repeat:["","x","y","space","round"]}],at=()=>["auto","cover","contain",tn,Yr,{size:[k,v]}],Ee=()=>[Ge,ce,K],R=()=>["","none","full",l,k,v],j=()=>["",A,ce,K],ye=()=>["solid","dashed","dotted","double"],ct=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],G=()=>[A,Ge,bt,gt],lt=()=>["","none",w,k,v],ve=()=>["none",A,k,v],ke=()=>["none",A,k,v],Ue=()=>[A,k,v],we=()=>[Z,"full",...b()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[q],breakpoint:[q],color:[Jr],container:[q],"drop-shadow":[q],ease:["in","out","in-out"],font:[Xr],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[q],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[q],shadow:[q],spacing:["px",A],text:[q],"text-shadow":[q],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Z,v,k,y]}],container:["container"],columns:[{columns:[A,v,k,u]}],"break-after":[{"break-after":S()}],"break-before":[{"break-before":S()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:P()}],overflow:[{overflow:E()}],"overflow-x":[{"overflow-x":E()}],"overflow-y":[{"overflow-y":E()}],overscroll:[{overscroll:g()}],"overscroll-x":[{"overscroll-x":g()}],"overscroll-y":[{"overscroll-y":g()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:_()}],"inset-x":[{"inset-x":_()}],"inset-y":[{"inset-y":_()}],start:[{start:_()}],end:[{end:_()}],top:[{top:_()}],right:[{right:_()}],bottom:[{bottom:_()}],left:[{left:_()}],visibility:["visible","invisible","collapse"],z:[{z:[$,"auto",k,v]}],basis:[{basis:[Z,"full","auto",u,...b()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[A,Z,"auto","initial","none",v]}],grow:[{grow:["",A,k,v]}],shrink:[{shrink:["",A,k,v]}],order:[{order:[$,"first","last","none",k,v]}],"grid-cols":[{"grid-cols":N()}],"col-start-end":[{col:M()}],"col-start":[{"col-start":C()}],"col-end":[{"col-end":C()}],"grid-rows":[{"grid-rows":N()}],"row-start-end":[{row:M()}],"row-start":[{"row-start":C()}],"row-end":[{"row-end":C()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":U()}],"auto-rows":[{"auto-rows":U()}],gap:[{gap:b()}],"gap-x":[{"gap-x":b()}],"gap-y":[{"gap-y":b()}],"justify-content":[{justify:[...O(),"normal"]}],"justify-items":[{"justify-items":[...z(),"normal"]}],"justify-self":[{"justify-self":["auto",...z()]}],"align-content":[{content:["normal",...O()]}],"align-items":[{items:[...z(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...z(),{baseline:["","last"]}]}],"place-content":[{"place-content":O()}],"place-items":[{"place-items":[...z(),"baseline"]}],"place-self":[{"place-self":["auto",...z()]}],p:[{p:b()}],px:[{px:b()}],py:[{py:b()}],ps:[{ps:b()}],pe:[{pe:b()}],pt:[{pt:b()}],pr:[{pr:b()}],pb:[{pb:b()}],pl:[{pl:b()}],m:[{m:V()}],mx:[{mx:V()}],my:[{my:V()}],ms:[{ms:V()}],me:[{me:V()}],mt:[{mt:V()}],mr:[{mr:V()}],mb:[{mb:V()}],ml:[{ml:V()}],"space-x":[{"space-x":b()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":b()}],"space-y-reverse":["space-y-reverse"],size:[{size:F()}],w:[{w:[u,"screen",...F()]}],"min-w":[{"min-w":[u,"screen","none",...F()]}],"max-w":[{"max-w":[u,"screen","none","prose",{screen:[o]},...F()]}],h:[{h:["screen","lh",...F()]}],"min-h":[{"min-h":["screen","lh","none",...F()]}],"max-h":[{"max-h":["screen","lh",...F()]}],"font-size":[{text:["base",n,ce,K]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[s,k,Re]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Ge,v]}],"font-family":[{font:[en,v,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,k,v]}],"line-clamp":[{"line-clamp":[A,"none",k,Re]}],leading:[{leading:[r,...b()]}],"list-image":[{"list-image":["none",k,v]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",k,v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:T()}],"text-color":[{text:T()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ye(),"wavy"]}],"text-decoration-thickness":[{decoration:[A,"from-font","auto",k,K]}],"text-decoration-color":[{decoration:T()}],"underline-offset":[{"underline-offset":[A,"auto",k,v]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:b()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",k,v]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",k,v]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:Y()}],"bg-repeat":[{bg:oe()}],"bg-size":[{bg:at()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},$,k,v],radial:["",k,v],conic:[$,k,v]},rn,Zr]}],"bg-color":[{bg:T()}],"gradient-from-pos":[{from:Ee()}],"gradient-via-pos":[{via:Ee()}],"gradient-to-pos":[{to:Ee()}],"gradient-from":[{from:T()}],"gradient-via":[{via:T()}],"gradient-to":[{to:T()}],rounded:[{rounded:R()}],"rounded-s":[{"rounded-s":R()}],"rounded-e":[{"rounded-e":R()}],"rounded-t":[{"rounded-t":R()}],"rounded-r":[{"rounded-r":R()}],"rounded-b":[{"rounded-b":R()}],"rounded-l":[{"rounded-l":R()}],"rounded-ss":[{"rounded-ss":R()}],"rounded-se":[{"rounded-se":R()}],"rounded-ee":[{"rounded-ee":R()}],"rounded-es":[{"rounded-es":R()}],"rounded-tl":[{"rounded-tl":R()}],"rounded-tr":[{"rounded-tr":R()}],"rounded-br":[{"rounded-br":R()}],"rounded-bl":[{"rounded-bl":R()}],"border-w":[{border:j()}],"border-w-x":[{"border-x":j()}],"border-w-y":[{"border-y":j()}],"border-w-s":[{"border-s":j()}],"border-w-e":[{"border-e":j()}],"border-w-t":[{"border-t":j()}],"border-w-r":[{"border-r":j()}],"border-w-b":[{"border-b":j()}],"border-w-l":[{"border-l":j()}],"divide-x":[{"divide-x":j()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":j()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ye(),"hidden","none"]}],"divide-style":[{divide:[...ye(),"hidden","none"]}],"border-color":[{border:T()}],"border-color-x":[{"border-x":T()}],"border-color-y":[{"border-y":T()}],"border-color-s":[{"border-s":T()}],"border-color-e":[{"border-e":T()}],"border-color-t":[{"border-t":T()}],"border-color-r":[{"border-r":T()}],"border-color-b":[{"border-b":T()}],"border-color-l":[{"border-l":T()}],"divide-color":[{divide:T()}],"outline-style":[{outline:[...ye(),"none","hidden"]}],"outline-offset":[{"outline-offset":[A,k,v]}],"outline-w":[{outline:["",A,ce,K]}],"outline-color":[{outline:T()}],shadow:[{shadow:["","none",a,Ie,xe]}],"shadow-color":[{shadow:T()}],"inset-shadow":[{"inset-shadow":["none",d,Ie,xe]}],"inset-shadow-color":[{"inset-shadow":T()}],"ring-w":[{ring:j()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:T()}],"ring-offset-w":[{"ring-offset":[A,K]}],"ring-offset-color":[{"ring-offset":T()}],"inset-ring-w":[{"inset-ring":j()}],"inset-ring-color":[{"inset-ring":T()}],"text-shadow":[{"text-shadow":["none",h,Ie,xe]}],"text-shadow-color":[{"text-shadow":T()}],opacity:[{opacity:[A,k,v]}],"mix-blend":[{"mix-blend":[...ct(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ct()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[A]}],"mask-image-linear-from-pos":[{"mask-linear-from":G()}],"mask-image-linear-to-pos":[{"mask-linear-to":G()}],"mask-image-linear-from-color":[{"mask-linear-from":T()}],"mask-image-linear-to-color":[{"mask-linear-to":T()}],"mask-image-t-from-pos":[{"mask-t-from":G()}],"mask-image-t-to-pos":[{"mask-t-to":G()}],"mask-image-t-from-color":[{"mask-t-from":T()}],"mask-image-t-to-color":[{"mask-t-to":T()}],"mask-image-r-from-pos":[{"mask-r-from":G()}],"mask-image-r-to-pos":[{"mask-r-to":G()}],"mask-image-r-from-color":[{"mask-r-from":T()}],"mask-image-r-to-color":[{"mask-r-to":T()}],"mask-image-b-from-pos":[{"mask-b-from":G()}],"mask-image-b-to-pos":[{"mask-b-to":G()}],"mask-image-b-from-color":[{"mask-b-from":T()}],"mask-image-b-to-color":[{"mask-b-to":T()}],"mask-image-l-from-pos":[{"mask-l-from":G()}],"mask-image-l-to-pos":[{"mask-l-to":G()}],"mask-image-l-from-color":[{"mask-l-from":T()}],"mask-image-l-to-color":[{"mask-l-to":T()}],"mask-image-x-from-pos":[{"mask-x-from":G()}],"mask-image-x-to-pos":[{"mask-x-to":G()}],"mask-image-x-from-color":[{"mask-x-from":T()}],"mask-image-x-to-color":[{"mask-x-to":T()}],"mask-image-y-from-pos":[{"mask-y-from":G()}],"mask-image-y-to-pos":[{"mask-y-to":G()}],"mask-image-y-from-color":[{"mask-y-from":T()}],"mask-image-y-to-color":[{"mask-y-to":T()}],"mask-image-radial":[{"mask-radial":[k,v]}],"mask-image-radial-from-pos":[{"mask-radial-from":G()}],"mask-image-radial-to-pos":[{"mask-radial-to":G()}],"mask-image-radial-from-color":[{"mask-radial-from":T()}],"mask-image-radial-to-color":[{"mask-radial-to":T()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":m()}],"mask-image-conic-pos":[{"mask-conic":[A]}],"mask-image-conic-from-pos":[{"mask-conic-from":G()}],"mask-image-conic-to-pos":[{"mask-conic-to":G()}],"mask-image-conic-from-color":[{"mask-conic-from":T()}],"mask-image-conic-to-color":[{"mask-conic-to":T()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:Y()}],"mask-repeat":[{mask:oe()}],"mask-size":[{mask:at()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",k,v]}],filter:[{filter:["","none",k,v]}],blur:[{blur:lt()}],brightness:[{brightness:[A,k,v]}],contrast:[{contrast:[A,k,v]}],"drop-shadow":[{"drop-shadow":["","none",f,Ie,xe]}],"drop-shadow-color":[{"drop-shadow":T()}],grayscale:[{grayscale:["",A,k,v]}],"hue-rotate":[{"hue-rotate":[A,k,v]}],invert:[{invert:["",A,k,v]}],saturate:[{saturate:[A,k,v]}],sepia:[{sepia:["",A,k,v]}],"backdrop-filter":[{"backdrop-filter":["","none",k,v]}],"backdrop-blur":[{"backdrop-blur":lt()}],"backdrop-brightness":[{"backdrop-brightness":[A,k,v]}],"backdrop-contrast":[{"backdrop-contrast":[A,k,v]}],"backdrop-grayscale":[{"backdrop-grayscale":["",A,k,v]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[A,k,v]}],"backdrop-invert":[{"backdrop-invert":["",A,k,v]}],"backdrop-opacity":[{"backdrop-opacity":[A,k,v]}],"backdrop-saturate":[{"backdrop-saturate":[A,k,v]}],"backdrop-sepia":[{"backdrop-sepia":["",A,k,v]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":b()}],"border-spacing-x":[{"border-spacing-x":b()}],"border-spacing-y":[{"border-spacing-y":b()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",k,v]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[A,"initial",k,v]}],ease:[{ease:["linear","initial",p,k,v]}],delay:[{delay:[A,k,v]}],animate:[{animate:["none",x,k,v]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[I,k,v]}],"perspective-origin":[{"perspective-origin":P()}],rotate:[{rotate:ve()}],"rotate-x":[{"rotate-x":ve()}],"rotate-y":[{"rotate-y":ve()}],"rotate-z":[{"rotate-z":ve()}],scale:[{scale:ke()}],"scale-x":[{"scale-x":ke()}],"scale-y":[{"scale-y":ke()}],"scale-z":[{"scale-z":ke()}],"scale-3d":["scale-3d"],skew:[{skew:Ue()}],"skew-x":[{"skew-x":Ue()}],"skew-y":[{"skew-y":Ue()}],transform:[{transform:[k,v,"","none","gpu","cpu"]}],"transform-origin":[{origin:P()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:we()}],"translate-x":[{"translate-x":we()}],"translate-y":[{"translate-y":we()}],"translate-z":[{"translate-z":we()}],"translate-none":["translate-none"],accent:[{accent:T()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:T()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",k,v]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":b()}],"scroll-mx":[{"scroll-mx":b()}],"scroll-my":[{"scroll-my":b()}],"scroll-ms":[{"scroll-ms":b()}],"scroll-me":[{"scroll-me":b()}],"scroll-mt":[{"scroll-mt":b()}],"scroll-mr":[{"scroll-mr":b()}],"scroll-mb":[{"scroll-mb":b()}],"scroll-ml":[{"scroll-ml":b()}],"scroll-p":[{"scroll-p":b()}],"scroll-px":[{"scroll-px":b()}],"scroll-py":[{"scroll-py":b()}],"scroll-ps":[{"scroll-ps":b()}],"scroll-pe":[{"scroll-pe":b()}],"scroll-pt":[{"scroll-pt":b()}],"scroll-pr":[{"scroll-pr":b()}],"scroll-pb":[{"scroll-pb":b()}],"scroll-pl":[{"scroll-pl":b()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",k,v]}],fill:[{fill:["none",...T()]}],"stroke-w":[{stroke:[A,ce,K,Re]}],stroke:[{stroke:["none",...T()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},an=zr(on);function ss(e,t){return`${t}/${e}`}function is(){return ie()?/iPhone|iPad|iPod|Android/i.test(navigator.userAgent):!1}function ie(){return typeof window=="object"}function os(e){if(!ln(e))throw new Error('An argument for "seconds" was not provided for formatTime.');let t=String(Math.floor(e/60));t.length===1&&(t="0"+t);let n=String(Math.floor(e%60));return n.length===1&&(n="0"+n),`${t}:${n}`}const as={sm:650,md:800};class cs{promise;resolve;reject;constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}function ls(e){return e?e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "):""}function yt(e){if(e.length!==7||e[0]!=="#")return ie()&&console.error("invalid hex value."),[];const t=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),s=parseInt(e.slice(5),16);return[t,n,s]}function us(e,t,n){const s=n,i=1-s,r=yt(e),o=yt(t);return"#"+[Math.round(r[0]*s+o[0]*i),Math.round(r[1]*s+o[1]*i),Math.round(r[2]*s+o[2]*i)].map(c=>c.toString(16).padStart(2,"0")).join("")}function ds(e,{min:t,max:n}){return isNaN(e)?n??t:(t!=null&&(e=Math.max(e,t)),n!=null&&(e=Math.min(e,n)),e)}function vt(e,t=0){return e?parseFloat(e.toFixed(t)):0}function fs(e,t){return Object.entries(e).reduce((n,[s,i])=>(n[s]=t(i,s),n),{})}function cn(e){let t,n;for(let[s,i]of Object.entries(e.tracks))i.hand==="left"?t=parseInt(s,10):i.hand==="right"&&(n=parseInt(s,10));return{left:t,right:n}}function ln(e){return Number.isFinite(e)}function hs(...e){return an(Tr(e))}function ps(e){if("fromBase64"in Uint8Array)return Uint8Array.fromBase64(e);const t=atob(e),n=t.length,s=new Uint8Array(n);for(let i=0;i<n;i++)s[i]=t.charCodeAt(i);return s}function ms(e){if("toBase64"in Uint8Array)return Uint8Array.toBase64(e);let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function gs(){return["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"]}const un={C:["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],G:["C","C#","D","D#","E","F♮","F","G","G#","A","A#","B"],D:["C♮","C","D","D#","E","F♮","F","G","G#","A","A#","B"],A:["C♮","C","D","D#","E","F♮","F","G♮","G","A","A#","B"],E:["C♮","C","D♮","D","E","F♮","F","G♮","G","A","A#","B"],B:["C♮","C","D♮","D","E","F♮","F","G♮","G","A♮","A","B"],"F#":["C♮","C","D♮","D","E♮","E","F","G♮","G","A♮","A","B"],"C#":["B","C","D♮","D","E♮","E","F","G♮","G","A♮","A","B♮"],F:["C","D♭","D","E♭","E","F","G♭","G","A♭","A","B","B♮"],Bb:["C","D♭","D","E","E♮","F","G♭","G","A♭","A","B","B♮"],Eb:["C","D♭","D","E","E♮","F","G♭","G","A","A♮","B","B♮"],Ab:["C","D","D♮","E","E♮","F","G♭","G","A","A♮","B","B♮"],Db:["C","D","D♮","E","E♮","F","G","G♮","A","A♮","B","B♮"],Gb:["C♮","D","D♮","E","E♮","F","G","G♮","A","A♮","B","C"],Cb:["C♮","D","D♮","E","E","F♮","G","G♮","A","A♮","B","C"]};let dn=fn();function fn(){return{C:{notes:[],type:"sharp"},G:{notes:["F"],type:"sharp"},D:{notes:["F","C"],type:"sharp"},A:{notes:["F","C","G"],type:"sharp"},E:{notes:["F","C","G","D"],type:"sharp"},B:{notes:["F","C","G","D","A"],type:"sharp"},"F#":{notes:["F","C","G","D","A","E"],type:"sharp"},"C#":{notes:["F","C","G","D","A","E","B"],type:"sharp"},F:{notes:["B"],type:"flat"},Bb:{notes:["B","E"],type:"flat"},Eb:{notes:["B","E","A"],type:"flat"},Ab:{notes:["B","E","A","D"],type:"flat"},Db:{notes:["B","E","A","D","G"],type:"flat"},Gb:{notes:["B","E","A","D","G","C"],type:"flat"},Cb:{notes:["B","E","A","D","G","C","F"],type:"flat"}}}const hn={"-7":"Cb","-6":"Gb","-5":"Db","-4":"Ab","-3":"Eb","-2":"Bb","-1":"F",0:"C",1:"G",2:"D",3:"A",4:"E",5:"B",6:"F#",7:"C#"},pn=Object.fromEntries(Object.entries(hn).map(([e,t])=>[t,e]));function bs(e){return dn[e]}function mn(e){e=e%8;const t=[0,2,4,5,7,9,11],n=7;return t.map(s=>((s+e*n)%12+12)%12)}function ys(e,t,n){const s=+pn[n],i=mn(s);return 24+(kt(e,t)-1)*12+i[kt(0,6)]}function kt(e,t){return Math.floor(Math.random()*(t-e+1)+e)}const nr={};(function(){const n=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"];for(let s=21;s<=108;s++){const i=(s-12)/12>>0,r=n[s%12]+i;nr[r]=s}})();function wt(e){return nr[e]}function vs(e,t="C"){return un[t][e%12]}function gn(e){return Math.floor((e-12)/12)}const bn={C:"Do",D:"Re",E:"Mi",F:"Fa",G:"Sol",A:"La",B:"Si"};function ks(e){const t=e[0],n=e.length===2?e[1]:void 0;return`${bn[t]??t}${n??""}`}var H={},Se={},ze,xt;function yn(){if(xt)return ze;xt=1;function e(i){var r=new s(i),o=r.readChunk();if(o.id!="MThd")throw"Bad MIDI file.  Expected 'MHdr', got: '"+o.id+"'";for(var u=t(o.data),c=[],l=0;!r.eof()&&l<u.numTracks;l++){var a=r.readChunk();if(a.id!="MTrk")throw"Bad MIDI file.  Expected 'MTrk', got: '"+a.id+"'";var d=n(a.data);c.push(d)}return{header:u,tracks:c}}function t(i){var r=new s(i),o=r.readUInt16(),u=r.readUInt16(),c={format:o,numTracks:u},l=r.readUInt16();return l&32768?(c.framesPerSecond=256-(l>>8),c.ticksPerFrame=l&255):c.ticksPerBeat=l,c}function n(i){for(var r=new s(i),o=[];!r.eof();){var u=l();o.push(u)}return o;var c;function l(){var a={};a.deltaTime=r.readVarInt();var d=r.readUInt8();if((d&240)===240)if(d===255){a.meta=!0;var h=r.readUInt8(),f=r.readVarInt();switch(h){case 0:if(a.type="sequenceNumber",f!==2)throw"Expected length for sequenceNumber event is 2, got "+f;return a.number=r.readUInt16(),a;case 1:return a.type="text",a.text=r.readString(f),a;case 2:return a.type="copyrightNotice",a.text=r.readString(f),a;case 3:return a.type="trackName",a.text=r.readString(f),a;case 4:return a.type="instrumentName",a.text=r.readString(f),a;case 5:return a.type="lyrics",a.text=r.readString(f),a;case 6:return a.type="marker",a.text=r.readString(f),a;case 7:return a.type="cuePoint",a.text=r.readString(f),a;case 32:if(a.type="channelPrefix",f!=1)throw"Expected length for channelPrefix event is 1, got "+f;return a.channel=r.readUInt8(),a;case 33:if(a.type="portPrefix",f!=1)throw"Expected length for portPrefix event is 1, got "+f;return a.port=r.readUInt8(),a;case 47:if(a.type="endOfTrack",f!=0)throw"Expected length for endOfTrack event is 0, got "+f;return a;case 81:if(a.type="setTempo",f!=3)throw"Expected length for setTempo event is 3, got "+f;return a.microsecondsPerBeat=r.readUInt24(),a;case 84:if(a.type="smpteOffset",f!=5)throw"Expected length for smpteOffset event is 5, got "+f;var w=r.readUInt8(),I={0:24,32:25,64:29,96:30};return a.frameRate=I[w&96],a.hour=w&31,a.min=r.readUInt8(),a.sec=r.readUInt8(),a.frame=r.readUInt8(),a.subFrame=r.readUInt8(),a;case 88:if(a.type="timeSignature",f!=2&&f!=4)throw"Expected length for timeSignature event is 4 or 2, got "+f;return a.numerator=r.readUInt8(),a.denominator=1<<r.readUInt8(),f===4?(a.metronome=r.readUInt8(),a.thirtyseconds=r.readUInt8()):(a.metronome=36,a.thirtyseconds=8),a;case 89:if(a.type="keySignature",f!=2)throw"Expected length for keySignature event is 2, got "+f;return a.key=r.readInt8(),a.scale=r.readUInt8(),a;case 127:return a.type="sequencerSpecific",a.data=r.readBytes(f),a;default:return a.type="unknownMeta",a.data=r.readBytes(f),a.metatypeByte=h,a}}else if(d==240){a.type="sysEx";var f=r.readVarInt();return a.data=r.readBytes(f),a}else if(d==247){a.type="endSysEx";var f=r.readVarInt();return a.data=r.readBytes(f),a}else throw"Unrecognised MIDI event type byte: "+d;else{var y;if((d&128)===0){if(c===null)throw"Running status byte encountered before status byte";y=d,d=c,a.running=!0}else y=r.readUInt8(),c=d;var p=d>>4;switch(a.channel=d&15,p){case 8:return a.type="noteOff",a.noteNumber=y,a.velocity=r.readUInt8(),a;case 9:var x=r.readUInt8();return a.type=x===0?"noteOff":"noteOn",a.noteNumber=y,a.velocity=x,x===0&&(a.byte9=!0),a;case 10:return a.type="noteAftertouch",a.noteNumber=y,a.amount=r.readUInt8(),a;case 11:return a.type="controller",a.controllerType=y,a.value=r.readUInt8(),a;case 12:return a.type="programChange",a.programNumber=y,a;case 13:return a.type="channelAftertouch",a.amount=y,a;case 14:return a.type="pitchBend",a.value=y+(r.readUInt8()<<7)-8192,a;default:throw"Unrecognised MIDI event type: "+p}}}}function s(i){this.buffer=i,this.bufferLen=this.buffer.length,this.pos=0}return s.prototype.eof=function(){return this.pos>=this.bufferLen},s.prototype.readUInt8=function(){var i=this.buffer[this.pos];return this.pos+=1,i},s.prototype.readInt8=function(){var i=this.readUInt8();return i&128?i-256:i},s.prototype.readUInt16=function(){var i=this.readUInt8(),r=this.readUInt8();return(i<<8)+r},s.prototype.readInt16=function(){var i=this.readUInt16();return i&32768?i-65536:i},s.prototype.readUInt24=function(){var i=this.readUInt8(),r=this.readUInt8(),o=this.readUInt8();return(i<<16)+(r<<8)+o},s.prototype.readInt24=function(){var i=this.readUInt24();return i&8388608?i-16777216:i},s.prototype.readUInt32=function(){var i=this.readUInt8(),r=this.readUInt8(),o=this.readUInt8(),u=this.readUInt8();return(i<<24)+(r<<16)+(o<<8)+u},s.prototype.readBytes=function(i){var r=this.buffer.slice(this.pos,this.pos+i);return this.pos+=i,r},s.prototype.readString=function(i){var r=this.readBytes(i);return String.fromCharCode.apply(null,r)},s.prototype.readVarInt=function(){for(var i=0;!this.eof();){var r=this.readUInt8();if(r&128)i+=r&127,i<<=7;else return i+r}return i},s.prototype.readChunk=function(){var i=this.readString(4),r=this.readUInt32(),o=this.readBytes(r);return{id:i,length:r,data:o}},ze=e,ze}var Ve,It;function vn(){if(It)return Ve;It=1;function e(r,o){if(typeof r!="object")throw"Invalid MIDI data";o=o||{};var u=r.header||{},c=r.tracks||[],l,a=c.length,d=new i;for(t(d,u,a),l=0;l<a;l++)n(d,c[l],o);return d.buffer}function t(r,o,u){var c=o.format==null?1:o.format,l=128;o.timeDivision?l=o.timeDivision:o.ticksPerFrame&&o.framesPerSecond?l=-(o.framesPerSecond&255)<<8|o.ticksPerFrame&255:o.ticksPerBeat&&(l=o.ticksPerBeat&32767);var a=new i;a.writeUInt16(c),a.writeUInt16(u),a.writeUInt16(l),r.writeChunk("MThd",a.buffer)}function n(r,o,u){var c=new i,l,a=o.length,d=null;for(l=0;l<a;l++)(u.running===!1||!u.running&&!o[l].running)&&(d=null),d=s(c,o[l],d,u.useByte9ForNoteOff);r.writeChunk("MTrk",c.buffer)}function s(r,o,u,c){var l=o.type,a=o.deltaTime,d=o.text||"",h=o.data||[],f=null;switch(r.writeVarInt(a),l){case"sequenceNumber":r.writeUInt8(255),r.writeUInt8(0),r.writeVarInt(2),r.writeUInt16(o.number);break;case"text":r.writeUInt8(255),r.writeUInt8(1),r.writeVarInt(d.length),r.writeString(d);break;case"copyrightNotice":r.writeUInt8(255),r.writeUInt8(2),r.writeVarInt(d.length),r.writeString(d);break;case"trackName":r.writeUInt8(255),r.writeUInt8(3),r.writeVarInt(d.length),r.writeString(d);break;case"instrumentName":r.writeUInt8(255),r.writeUInt8(4),r.writeVarInt(d.length),r.writeString(d);break;case"lyrics":r.writeUInt8(255),r.writeUInt8(5),r.writeVarInt(d.length),r.writeString(d);break;case"marker":r.writeUInt8(255),r.writeUInt8(6),r.writeVarInt(d.length),r.writeString(d);break;case"cuePoint":r.writeUInt8(255),r.writeUInt8(7),r.writeVarInt(d.length),r.writeString(d);break;case"channelPrefix":r.writeUInt8(255),r.writeUInt8(32),r.writeVarInt(1),r.writeUInt8(o.channel);break;case"portPrefix":r.writeUInt8(255),r.writeUInt8(33),r.writeVarInt(1),r.writeUInt8(o.port);break;case"endOfTrack":r.writeUInt8(255),r.writeUInt8(47),r.writeVarInt(0);break;case"setTempo":r.writeUInt8(255),r.writeUInt8(81),r.writeVarInt(3),r.writeUInt24(o.microsecondsPerBeat);break;case"smpteOffset":r.writeUInt8(255),r.writeUInt8(84),r.writeVarInt(5);var w={24:0,25:32,29:64,30:96},I=o.hour&31|w[o.frameRate];r.writeUInt8(I),r.writeUInt8(o.min),r.writeUInt8(o.sec),r.writeUInt8(o.frame),r.writeUInt8(o.subFrame);break;case"timeSignature":r.writeUInt8(255),r.writeUInt8(88),r.writeVarInt(4),r.writeUInt8(o.numerator);var y=Math.floor(Math.log(o.denominator)/Math.LN2)&255;r.writeUInt8(y),r.writeUInt8(o.metronome),r.writeUInt8(o.thirtyseconds||8);break;case"keySignature":r.writeUInt8(255),r.writeUInt8(89),r.writeVarInt(2),r.writeInt8(o.key),r.writeUInt8(o.scale);break;case"sequencerSpecific":r.writeUInt8(255),r.writeUInt8(127),r.writeVarInt(h.length),r.writeBytes(h);break;case"unknownMeta":o.metatypeByte!=null&&(r.writeUInt8(255),r.writeUInt8(o.metatypeByte),r.writeVarInt(h.length),r.writeBytes(h));break;case"sysEx":r.writeUInt8(240),r.writeVarInt(h.length),r.writeBytes(h);break;case"endSysEx":r.writeUInt8(247),r.writeVarInt(h.length),r.writeBytes(h);break;case"noteOff":var p=c!==!1&&o.byte9||c&&o.velocity==0?144:128;f=p|o.channel,f!==u&&r.writeUInt8(f),r.writeUInt8(o.noteNumber),r.writeUInt8(o.velocity);break;case"noteOn":f=144|o.channel,f!==u&&r.writeUInt8(f),r.writeUInt8(o.noteNumber),r.writeUInt8(o.velocity);break;case"noteAftertouch":f=160|o.channel,f!==u&&r.writeUInt8(f),r.writeUInt8(o.noteNumber),r.writeUInt8(o.amount);break;case"controller":f=176|o.channel,f!==u&&r.writeUInt8(f),r.writeUInt8(o.controllerType),r.writeUInt8(o.value);break;case"programChange":f=192|o.channel,f!==u&&r.writeUInt8(f),r.writeUInt8(o.programNumber);break;case"channelAftertouch":f=208|o.channel,f!==u&&r.writeUInt8(f),r.writeUInt8(o.amount);break;case"pitchBend":f=224|o.channel,f!==u&&r.writeUInt8(f);var x=8192+o.value,S=x&127,m=x>>7&127;r.writeUInt8(S),r.writeUInt8(m);break;default:throw"Unrecognized event type: "+l}return f}function i(){this.buffer=[]}return i.prototype.writeUInt8=function(r){this.buffer.push(r&255)},i.prototype.writeInt8=i.prototype.writeUInt8,i.prototype.writeUInt16=function(r){var o=r>>8&255,u=r&255;this.writeUInt8(o),this.writeUInt8(u)},i.prototype.writeInt16=i.prototype.writeUInt16,i.prototype.writeUInt24=function(r){var o=r>>16&255,u=r>>8&255,c=r&255;this.writeUInt8(o),this.writeUInt8(u),this.writeUInt8(c)},i.prototype.writeInt24=i.prototype.writeUInt24,i.prototype.writeUInt32=function(r){var o=r>>24&255,u=r>>16&255,c=r>>8&255,l=r&255;this.writeUInt8(o),this.writeUInt8(u),this.writeUInt8(c),this.writeUInt8(l)},i.prototype.writeInt32=i.prototype.writeUInt32,i.prototype.writeBytes=function(r){this.buffer=this.buffer.concat(Array.prototype.slice.call(r,0))},i.prototype.writeString=function(r){var o,u=r.length,c=[];for(o=0;o<u;o++)c.push(r.codePointAt(o));this.writeBytes(c)},i.prototype.writeVarInt=function(r){if(r<0)throw"Cannot write negative variable-length integer";if(r<=127)this.writeUInt8(r);else{var o=r,u=[];for(u.push(o&127),o>>=7;o;){var c=o&127|128;u.push(c),o>>=7}this.writeBytes(u.reverse())}},i.prototype.writeChunk=function(r,o){this.writeString(r),this.writeUInt32(o.length),this.writeBytes(o)},Ve=e,Ve}var St;function sr(){return St||(St=1,Se.parseMidi=yn(),Se.writeMidi=vn()),Se}var je={},Q={},_t;function ir(){if(_t)return Q;_t=1,Object.defineProperty(Q,"__esModule",{value:!0}),Q.insert=Q.search=void 0;function e(n,s,i){i===void 0&&(i="ticks");var r=0,o=n.length,u=o;if(o>0&&n[o-1][i]<=s)return o-1;for(;r<u;){var c=Math.floor(r+(u-r)/2),l=n[c],a=n[c+1];if(l[i]===s){for(var d=c;d<n.length;d++){var h=n[d];h[i]===s&&(c=d)}return c}else{if(l[i]<s&&a[i]>s)return c;l[i]>s?u=c:l[i]<s&&(r=c+1)}}return-1}Q.search=e;function t(n,s,i){if(i===void 0&&(i="ticks"),n.length){var r=e(n,s[i],i);n.splice(r+1,0,s)}else n.push(s)}return Q.insert=t,Q}var Tt;function Ze(){return Tt||(Tt=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Header=e.keySignatureKeys=void 0;var t=ir(),n=new WeakMap;e.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var s=(function(){function i(r){var o=this;if(this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",n.set(this,480),r){n.set(this,r.header.ticksPerBeat),r.tracks.forEach(function(c){c.forEach(function(l){l.meta&&(l.type==="timeSignature"?o.timeSignatures.push({ticks:l.absoluteTime,timeSignature:[l.numerator,l.denominator]}):l.type==="setTempo"?o.tempos.push({bpm:6e7/l.microsecondsPerBeat,ticks:l.absoluteTime}):l.type==="keySignature"&&o.keySignatures.push({key:e.keySignatureKeys[l.key+7],scale:l.scale===0?"major":"minor",ticks:l.absoluteTime}))})});var u=0;r.tracks[0].forEach(function(c){u+=c.deltaTime,c.meta&&(c.type==="trackName"?o.name=c.text:(c.type==="text"||c.type==="cuePoint"||c.type==="marker"||c.type==="lyrics")&&o.meta.push({text:c.text,ticks:u,type:c.type}))}),this.update()}}return i.prototype.update=function(){var r=this,o=0,u=0;this.tempos.sort(function(c,l){return c.ticks-l.ticks}),this.tempos.forEach(function(c,l){var a=l>0?r.tempos[l-1].bpm:r.tempos[0].bpm,d=c.ticks/r.ppq-u,h=60/a*d;c.time=h+o,o=c.time,u+=d}),this.timeSignatures.sort(function(c,l){return c.ticks-l.ticks}),this.timeSignatures.forEach(function(c,l){var a=l>0?r.timeSignatures[l-1]:r.timeSignatures[0],d=(c.ticks-a.ticks)/r.ppq,h=d/a.timeSignature[0]/(a.timeSignature[1]/4);a.measures=a.measures||0,c.measures=h+a.measures})},i.prototype.ticksToSeconds=function(r){var o=(0,t.search)(this.tempos,r);if(o!==-1){var u=this.tempos[o],c=u.time,l=(r-u.ticks)/this.ppq;return c+60/u.bpm*l}else{var a=r/this.ppq;return 60/120*a}},i.prototype.ticksToMeasures=function(r){var o=(0,t.search)(this.timeSignatures,r);if(o!==-1){var u=this.timeSignatures[o],c=(r-u.ticks)/this.ppq;return u.measures+c/(u.timeSignature[0]/u.timeSignature[1])/4}else return r/this.ppq/4},Object.defineProperty(i.prototype,"ppq",{get:function(){return n.get(this)},enumerable:!1,configurable:!0}),i.prototype.secondsToTicks=function(r){var o=(0,t.search)(this.tempos,r,"time");if(o!==-1){var u=this.tempos[o],c=u.time,l=r-c,a=l/(60/u.bpm);return Math.round(u.ticks+a*this.ppq)}else{var d=r/.5;return Math.round(d*this.ppq)}},i.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(r){return{bpm:r.bpm,ticks:r.ticks}}),timeSignatures:this.timeSignatures}},i.prototype.fromJSON=function(r){this.name=r.name,this.tempos=r.tempos.map(function(o){return Object.assign({},o)}),this.timeSignatures=r.timeSignatures.map(function(o){return Object.assign({},o)}),this.keySignatures=r.keySignatures.map(function(o){return Object.assign({},o)}),this.meta=r.meta.map(function(o){return Object.assign({},o)}),n.set(this,r.ppq),this.update()},i.prototype.setTempo=function(r){this.tempos=[{bpm:r,ticks:0}],this.update()},i})();e.Header=s})(je)),je}var le={},Le={},Ct;function or(){return Ct||(Ct=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ControlChange=e.controlChangeIds=e.controlChangeNames=void 0,e.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},e.controlChangeIds=Object.keys(e.controlChangeNames).reduce(function(i,r){return i[e.controlChangeNames[r]]=r,i},{});var t=new WeakMap,n=new WeakMap,s=(function(){function i(r,o){t.set(this,o),n.set(this,r.controllerType),this.ticks=r.absoluteTime,this.value=r.value}return Object.defineProperty(i.prototype,"number",{get:function(){return n.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return e.controlChangeNames[this.number]?e.controlChangeNames[this.number]:null},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"time",{get:function(){var r=t.get(this);return r.ticksToSeconds(this.ticks)},set:function(r){var o=t.get(this);this.ticks=o.secondsToTicks(r)},enumerable:!1,configurable:!0}),i.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},i})();e.ControlChange=s})(Le)),Le}var ue={},Mt;function kn(){if(Mt)return ue;Mt=1,Object.defineProperty(ue,"__esModule",{value:!0}),ue.createControlChanges=void 0;var e=or();function t(){return new Proxy({},{get:function(n,s){if(n[s])return n[s];if(e.controlChangeIds.hasOwnProperty(s))return n[e.controlChangeIds[s]]},set:function(n,s,i){return e.controlChangeIds.hasOwnProperty(s)?n[e.controlChangeIds[s]]=i:n[s]=i,!0}})}return ue.createControlChanges=t,ue}var de={},Nt;function wn(){if(Nt)return de;Nt=1,Object.defineProperty(de,"__esModule",{value:!0}),de.PitchBend=void 0;var e=new WeakMap,t=(function(){function n(s,i){e.set(this,i),this.ticks=s.absoluteTime,this.value=s.value}return Object.defineProperty(n.prototype,"time",{get:function(){var s=e.get(this);return s.ticksToSeconds(this.ticks)},set:function(s){var i=e.get(this);this.ticks=i.secondsToTicks(s)},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},n})();return de.PitchBend=t,de}var fe={},W={},At;function xn(){return At||(At=1,Object.defineProperty(W,"__esModule",{value:!0}),W.DrumKitByPatchID=W.InstrumentFamilyByID=W.instrumentByPatchID=void 0,W.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],W.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"],W.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"}),W}var Pt;function In(){if(Pt)return fe;Pt=1,Object.defineProperty(fe,"__esModule",{value:!0}),fe.Instrument=void 0;var e=xn(),t=new WeakMap,n=(function(){function s(i,r){if(this.number=0,t.set(this,r),this.number=0,i){var o=i.find(function(u){return u.type==="programChange"});o&&(this.number=o.programNumber)}}return Object.defineProperty(s.prototype,"name",{get:function(){return this.percussion?e.DrumKitByPatchID[this.number]:e.instrumentByPatchID[this.number]},set:function(i){var r=e.instrumentByPatchID.indexOf(i);r!==-1&&(this.number=r)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"family",{get:function(){return this.percussion?"drums":e.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"percussion",{get:function(){var i=t.get(this);return i.channel===9},enumerable:!1,configurable:!0}),s.prototype.toJSON=function(){return{family:this.family,number:this.number,name:this.name}},s.prototype.fromJSON=function(i){this.number=i.number},s})();return fe.Instrument=n,fe}var he={},Ft;function Sn(){if(Ft)return he;Ft=1,Object.defineProperty(he,"__esModule",{value:!0}),he.Note=void 0;function e(o){var u=Math.floor(o/12)-1;return t(o)+u.toString()}function t(o){var u=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],c=o%12;return u[c]}function n(o){var u=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return u.indexOf(o)}var s=(function(){var o=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,u={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(c){var l=o.exec(c),a=l[1],d=l[2],h=u[a.toLowerCase()];return h+(parseInt(d,10)+1)*12}})(),i=new WeakMap,r=(function(){function o(u,c,l){i.set(this,l),this.midi=u.midi,this.velocity=u.velocity,this.noteOffVelocity=c.velocity,this.ticks=u.ticks,this.durationTicks=c.ticks-u.ticks}return Object.defineProperty(o.prototype,"name",{get:function(){return e(this.midi)},set:function(u){this.midi=s(u)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(u){var c=u-this.octave;this.midi+=c*12},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"pitch",{get:function(){return t(this.midi)},set:function(u){this.midi=12*(this.octave+1)+n(u)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"duration",{get:function(){var u=i.get(this);return u.ticksToSeconds(this.ticks+this.durationTicks)-u.ticksToSeconds(this.ticks)},set:function(u){var c=i.get(this),l=c.secondsToTicks(this.time+u);this.durationTicks=l-this.ticks},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"time",{get:function(){var u=i.get(this);return u.ticksToSeconds(this.ticks)},set:function(u){var c=i.get(this);this.ticks=c.secondsToTicks(u)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"bars",{get:function(){var u=i.get(this);return u.ticksToMeasures(this.ticks)},enumerable:!1,configurable:!0}),o.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},o})();return he.Note=r,he}var Et;function Ut(){if(Et)return le;Et=1,Object.defineProperty(le,"__esModule",{value:!0}),le.Track=void 0;var e=ir(),t=or(),n=kn(),s=wn(),i=In(),r=Sn(),o=new WeakMap,u=(function(){function c(l,a){var d=this;if(this.name="",this.notes=[],this.controlChanges=(0,n.createControlChanges)(),this.pitchBends=[],o.set(this,a),l){var h=l.find(function(m){return m.type==="trackName"});this.name=h?h.text:""}if(this.instrument=new i.Instrument(l,this),this.channel=0,l){for(var f=l.filter(function(m){return m.type==="noteOn"}),w=l.filter(function(m){return m.type==="noteOff"}),I=function(){var m=f.shift();y.channel=m.channel;var P=w.findIndex(function(g){return g.noteNumber===m.noteNumber&&g.absoluteTime>=m.absoluteTime});if(P!==-1){var E=w.splice(P,1)[0];y.addNote({durationTicks:E.absoluteTime-m.absoluteTime,midi:m.noteNumber,noteOffVelocity:E.velocity/127,ticks:m.absoluteTime,velocity:m.velocity/127})}},y=this;f.length;)I();var p=l.filter(function(m){return m.type==="controller"});p.forEach(function(m){d.addCC({number:m.controllerType,ticks:m.absoluteTime,value:m.value/127})});var x=l.filter(function(m){return m.type==="pitchBend"});x.forEach(function(m){d.addPitchBend({ticks:m.absoluteTime,value:m.value/Math.pow(2,13)})});var S=l.find(function(m){return m.type==="endOfTrack"});this.endOfTrackTicks=S!==void 0?S.absoluteTime:void 0}}return c.prototype.addNote=function(l){var a=o.get(this),d=new r.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},a);return Object.assign(d,l),(0,e.insert)(this.notes,d,"ticks"),this},c.prototype.addCC=function(l){var a=o.get(this),d=new t.ControlChange({controllerType:l.number},a);return delete l.number,Object.assign(d,l),Array.isArray(this.controlChanges[d.number])||(this.controlChanges[d.number]=[]),(0,e.insert)(this.controlChanges[d.number],d,"ticks"),this},c.prototype.addPitchBend=function(l){var a=o.get(this),d=new s.PitchBend({},a);return Object.assign(d,l),(0,e.insert)(this.pitchBends,d,"ticks"),this},Object.defineProperty(c.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var l=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,a=0;a<this.notes.length-1;a++){var d=this.notes[a].time+this.notes[a].duration;l<d&&(l=d)}return l},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var l=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,a=0;a<this.notes.length-1;a++){var d=this.notes[a].ticks+this.notes[a].durationTicks;l<d&&(l=d)}return l},enumerable:!1,configurable:!0}),c.prototype.fromJSON=function(l){var a=this;this.name=l.name,this.channel=l.channel,this.instrument=new i.Instrument(void 0,this),this.instrument.fromJSON(l.instrument),l.endOfTrackTicks!==void 0&&(this.endOfTrackTicks=l.endOfTrackTicks);for(var d in l.controlChanges)l.controlChanges[d]&&l.controlChanges[d].forEach(function(h){a.addCC({number:h.number,ticks:h.ticks,value:h.value})});l.notes.forEach(function(h){a.addNote({durationTicks:h.durationTicks,midi:h.midi,ticks:h.ticks,velocity:h.velocity})})},c.prototype.toJSON=function(){for(var l={},a=0;a<127;a++)this.controlChanges.hasOwnProperty(a)&&(l[a]=this.controlChanges[a].map(function(h){return h.toJSON()}));var d={channel:this.channel,controlChanges:l,pitchBends:this.pitchBends.map(function(h){return h.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(h){return h.toJSON()})};return this.endOfTrackTicks!==void 0&&(d.endOfTrackTicks=this.endOfTrackTicks),d},c})();return le.Track=u,le}var X={};function _n(e){var t=[];return ar(e,t),t}function ar(e,t){for(var n=0;n<e.length;n++){var s=e[n];Array.isArray(s)?ar(s,t):t.push(s)}}const Tn=Object.freeze(Object.defineProperty({__proto__:null,flatten:_n},Symbol.toStringTag,{value:"Module"})),Cn=lr(Tn);var Bt;function Mn(){if(Bt)return X;Bt=1;var e=X&&X.__spreadArray||function(p,x,S){if(S||arguments.length===2)for(var m=0,P=x.length,E;m<P;m++)(E||!(m in x))&&(E||(E=Array.prototype.slice.call(x,0,m)),E[m]=x[m]);return p.concat(E||Array.prototype.slice.call(x))};Object.defineProperty(X,"__esModule",{value:!0}),X.encode=void 0;var t=sr(),n=Ze(),s=Cn;function i(p,x){return[{absoluteTime:p.ticks,channel:x,deltaTime:0,noteNumber:p.midi,type:"noteOn",velocity:Math.floor(p.velocity*127)},{absoluteTime:p.ticks+p.durationTicks,channel:x,deltaTime:0,noteNumber:p.midi,type:"noteOff",velocity:Math.floor(p.noteOffVelocity*127)}]}function r(p){return(0,s.flatten)(p.notes.map(function(x){return i(x,p.channel)}))}function o(p,x){return{absoluteTime:p.ticks,channel:x,controllerType:p.number,deltaTime:0,type:"controller",value:Math.floor(p.value*127)}}function u(p){for(var x=[],S=0;S<127;S++)p.controlChanges.hasOwnProperty(S)&&p.controlChanges[S].forEach(function(m){x.push(o(m,p.channel))});return x}function c(p,x){return{absoluteTime:p.ticks,channel:x,deltaTime:0,type:"pitchBend",value:p.value}}function l(p){var x=[];return p.pitchBends.forEach(function(S){x.push(c(S,p.channel))}),x}function a(p){return{absoluteTime:0,channel:p.channel,deltaTime:0,programNumber:p.instrument.number,type:"programChange"}}function d(p){return{absoluteTime:0,deltaTime:0,meta:!0,text:p,type:"trackName"}}function h(p){return{absoluteTime:p.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/p.bpm),type:"setTempo"}}function f(p){return{absoluteTime:p.ticks,deltaTime:0,denominator:p.timeSignature[1],meta:!0,metronome:24,numerator:p.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function w(p){var x=n.keySignatureKeys.indexOf(p.key);return{absoluteTime:p.ticks,deltaTime:0,key:x+7,meta:!0,scale:p.scale==="major"?0:1,type:"keySignature"}}function I(p){return{absoluteTime:p.ticks,deltaTime:0,meta:!0,text:p.text,type:p.type}}function y(p){var x={header:{format:1,numTracks:p.tracks.length+1,ticksPerBeat:p.header.ppq},tracks:e([e(e(e(e([{absoluteTime:0,deltaTime:0,meta:!0,text:p.header.name,type:"trackName"}],p.header.keySignatures.map(function(S){return w(S)}),!0),p.header.meta.map(function(S){return I(S)}),!0),p.header.tempos.map(function(S){return h(S)}),!0),p.header.timeSignatures.map(function(S){return f(S)}),!0)],p.tracks.map(function(S){return e(e(e([d(S.name),a(S)],r(S),!0),u(S),!0),l(S),!0)}),!0)};return x.tracks=x.tracks.map(function(S){S=S.sort(function(P,E){return P.absoluteTime-E.absoluteTime});var m=0;return S.forEach(function(P){P.deltaTime=P.absoluteTime-m,m=P.absoluteTime,delete P.absoluteTime}),S.push({deltaTime:0,meta:!0,type:"endOfTrack"}),S}),new Uint8Array((0,t.writeMidi)(x))}return X.encode=y,X}var Ot;function Nn(){return Ot||(Ot=1,(function(e){var t=H&&H.__awaiter||function(d,h,f,w){function I(y){return y instanceof f?y:new f(function(p){p(y)})}return new(f||(f=Promise))(function(y,p){function x(P){try{m(w.next(P))}catch(E){p(E)}}function S(P){try{m(w.throw(P))}catch(E){p(E)}}function m(P){P.done?y(P.value):I(P.value).then(x,S)}m((w=w.apply(d,h||[])).next())})},n=H&&H.__generator||function(d,h){var f={label:0,sent:function(){if(y[0]&1)throw y[1];return y[1]},trys:[],ops:[]},w,I,y,p;return p={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function x(m){return function(P){return S([m,P])}}function S(m){if(w)throw new TypeError("Generator is already executing.");for(;f;)try{if(w=1,I&&(y=m[0]&2?I.return:m[0]?I.throw||((y=I.return)&&y.call(I),0):I.next)&&!(y=y.call(I,m[1])).done)return y;switch(I=0,y&&(m=[m[0]&2,y.value]),m[0]){case 0:case 1:y=m;break;case 4:return f.label++,{value:m[1],done:!1};case 5:f.label++,I=m[1],m=[0];continue;case 7:m=f.ops.pop(),f.trys.pop();continue;default:if(y=f.trys,!(y=y.length>0&&y[y.length-1])&&(m[0]===6||m[0]===2)){f=0;continue}if(m[0]===3&&(!y||m[1]>y[0]&&m[1]<y[3])){f.label=m[1];break}if(m[0]===6&&f.label<y[1]){f.label=y[1],y=m;break}if(y&&f.label<y[2]){f.label=y[2],f.ops.push(m);break}y[2]&&f.ops.pop(),f.trys.pop();continue}m=h.call(d,f)}catch(P){m=[6,P],I=0}finally{w=y=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Header=e.Track=e.Midi=void 0;var s=sr(),i=Ze(),r=Ut(),o=Mn(),u=(function(){function d(h){var f=this,w=null;if(h){var I=h instanceof ArrayBuffer?new Uint8Array(h):h;w=(0,s.parseMidi)(I),w.tracks.forEach(function(y){var p=0;y.forEach(function(x){p+=x.deltaTime,x.absoluteTime=p})}),w.tracks=a(w.tracks)}this.header=new i.Header(w),this.tracks=[],h&&(this.tracks=w.tracks.map(function(y){return new r.Track(y,f.header)}),w.header.format===1&&this.tracks[0].duration===0&&this.tracks.shift())}return d.fromUrl=function(h){return t(this,void 0,void 0,function(){var f,w;return n(this,function(I){switch(I.label){case 0:return[4,fetch(h)];case 1:return f=I.sent(),f.ok?[4,f.arrayBuffer()]:[3,3];case 2:return w=I.sent(),[2,new d(w)];case 3:throw new Error("Could not load '".concat(h,"'"))}})})},Object.defineProperty(d.prototype,"name",{get:function(){return this.header.name},set:function(h){this.header.name=h},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"duration",{get:function(){var h=this.tracks.map(function(f){return f.duration});return Math.max.apply(Math,h)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"durationTicks",{get:function(){var h=this.tracks.map(function(f){return f.durationTicks});return Math.max.apply(Math,h)},enumerable:!1,configurable:!0}),d.prototype.addTrack=function(){var h=new r.Track(void 0,this.header);return this.tracks.push(h),h},d.prototype.toArray=function(){return(0,o.encode)(this)},d.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(h){return h.toJSON()})}},d.prototype.fromJSON=function(h){var f=this;this.header=new i.Header,this.header.fromJSON(h.header),this.tracks=h.tracks.map(function(w){var I=new r.Track(void 0,f.header);return I.fromJSON(w),I})},d.prototype.clone=function(){var h=new d;return h.fromJSON(this.toJSON()),h},d})();e.Midi=u;var c=Ut();Object.defineProperty(e,"Track",{enumerable:!0,get:function(){return c.Track}});var l=Ze();Object.defineProperty(e,"Header",{enumerable:!0,get:function(){return l.Header}});function a(d){for(var h=[],f=0;f<d.length;f++)for(var w=h.length,I=new Map,y=Array(16).fill(0),p=0,x=d[f];p<x.length;p++){var S=x[p],m=w,P=S.channel;if(P!==void 0){S.type==="programChange"&&(y[P]=S.programNumber);var E=y[P],g="".concat(E," ").concat(P);I.has(g)?m=I.get(g):(m=w+I.size,I.set(g,m))}h[m]||h.push([]),h[m].push(S)}return h}})(H)),H}var An=Nn();async function Pn(){if(!ie()||!window.navigator.requestMIDIAccess)return new Map;try{return(await window.navigator.requestMIDIAccess()).inputs}catch(e){return console.error("Error accessing MIDI devices: "+e),new Map}}async function ws(){if(!ie()||!window.navigator.requestMIDIAccess)return new Map;try{return(await window.navigator.requestMIDIAccess({sysex:!1})).outputs}catch(e){return console.error("Error accessing MIDI devices: "+e),new Map}}const Pe=new Map,ee=new Map;function xs(e){return Pe.has(e.id)}function Is(e){return ee.has(e.id)}function Fn(e){e.open(),e.addEventListener("midimessage",st),Pe.set(e.id,e)}function Ss(e){e.open(),ee.set(e.id,e)}function _s(e){const t=Pe.get(e.id);t&&(t.removeEventListener("midimessage",st),t.close(),Pe.delete(t.id))}function Ts(e){const t=ee.get(e.id);t&&(t.removeEventListener("midimessage",st),t.close(),ee.delete(t.id))}En();async function En(){const e=await Pn();for(const t of e.values())t.name?.toLowerCase().includes("through")||Fn(t)}function Un(e){const t=e.data;return t.length!==3?null:{type:t[0]>>>4===9?"on":"off",note:t[1],velocity:t[2],timeStamp:e.timeStamp}}function Bn(){const e=["C","D","E","F","G","A","B"],t=["Db","Eb","Gb","Ab","Bb"],n=[{keys:"zxcvbnm",notes:e,octave:3},{keys:"sdghj",notes:t,octave:3},{keys:"qwertyu",notes:e,octave:4},{keys:"23567",notes:t,octave:4}],s={};for(const{keys:i,notes:r,octave:o}of n)for(let u=0;u<i.length;u++){const c=i[u],a=(/\d/.test(c)?"Digit":"Key")+c.toUpperCase();s[a]=[r[u],o]}return s}const pe=Bn();class On{octaveDiff=0;pressedNotes=new Map;keyPressedNotes=new Set;listeners=[];handleKeyDown(t){let{key:n,code:s,metaKey:i,ctrlKey:r,altKey:o}=t;if(!(i||r||o)&&!(!(s in pe)&&n!=="ArrowUp"&&n!=="ArrowDown")&&(t.preventDefault(),t.stopPropagation(),!t.repeat)){if(n==="ArrowUp")this.octaveDiff=Math.min(4,this.octaveDiff+2),this.keyPressedNotes.forEach(u=>this.release(u)),this.keyPressedNotes.clear();else if(n==="ArrowDown")this.octaveDiff=Math.max(-4,this.octaveDiff-2),this.keyPressedNotes.forEach(u=>this.release(u)),this.keyPressedNotes.clear();else if(s in pe){const[u,c]=pe[s],l=c+this.octaveDiff,a=wt(u+l);a&&(this.keyPressedNotes.add(a),this.press(a,80))}}}handleKeyUp(t){const n=t.code;if(n in pe){const[s,i]=pe[n],r=i+this.octaveDiff,o=wt(s+r);this.keyPressedNotes.delete(o),this.release(o)}}getListenerProps(){return{onKeyDown:t=>this.handleKeyDown(t),onKeyUp:t=>this.handleKeyUp(t),tabIndex:-1}}getPressedNotes(){return this.pressedNotes}press(t,n){const s=Date.now();this.pressedNotes.set(t,{time:s,vel:n}),this.notify({note:t,velocity:n,type:"down",time:s})}pressOutput(t,n){for(const i of ee){const o=n*127;var s=[144,t,o];i[1]?.send(s)}}release(t){this.pressedNotes.delete(t),this.notify({note:t,type:"up",time:Date.now()})}releaseOutput(t){for(const i of ee){var s=[128,t,127];i[1]?.send(s)}}notify(t){this.listeners.forEach(n=>n(t))}subscribe(t){this.listeners.push(t)}unsubscribe(t){let n=this.listeners.indexOf(t);this.listeners.splice(n,1)}}const te=new On;function st(e){const t=Un(e);if(!t)return;const{note:n,velocity:s}=t;t.type==="on"&&t.velocity>0?te.press(n,s):te.release(n)}function Dn(e){const t=new An.Midi,n=t.addTrack(),s=new Map;for(const i of e)if(i.type==="on")s.set(i.note,i);else{const r=s.get(i.note);if(!r)continue;s.delete(i.note);const o=i;n.addNote({midi:r.note,time:r.timeStamp/1e3,duration:(o.timeStamp-r.timeStamp)/1e3,velocity:r.velocity,noteOffVelocity:o.velocity})}return t.toArray()}function Gn(e){const t=[];let n=null;function s(i){n===null&&(n=i.time);const r={type:i.type==="down"?"on":"off",velocity:i.velocity??127,note:i.note,timeStamp:i.time-n};t.push(r)}return e.subscribe(s),()=>(e.unsubscribe(s),t.length>0?Dn(t):null)}function Cs(e=te){const[t,n]=L.useState(!1),s=L.useRef(null);function i(){n(!0),s.current&&s.current?.(),s.current=Gn(e)}function r(){n(!1);const o=s.current?.()??new Uint8Array;return s.current=null,o}return{startRecording:i,stopRecording:r,isRecording:t}}const be=["acoustic_grand_piano","bright_acoustic_piano","electric_grand_piano","honkytonk_piano","electric_piano_1","electric_piano_2","harpsichord","clavinet","celesta","glockenspiel","music_box","vibraphone","marimba","xylophone","tubular_bells","dulcimer","drawbar_organ","percussive_organ","rock_organ","church_organ","reed_organ","accordion","harmonica","tango_accordion","acoustic_guitar_nylon","acoustic_guitar_steel","electric_guitar_jazz","electric_guitar_clean","electric_guitar_muted","overdriven_guitar","distortion_guitar","guitar_harmonics","acoustic_bass","electric_bass_finger","electric_bass_pick","fretless_bass","slap_bass_1","slap_bass_2","synth_bass_1","synth_bass_2","violin","viola","cello","contrabass","tremolo_strings","pizzicato_strings","orchestral_harp","timpani","string_ensemble_1","string_ensemble_2","synth_strings_1","synth_strings_2","choir_aahs","voice_oohs","synth_choir","orchestra_hit","trumpet","trombone","tuba","muted_trumpet","french_horn","brass_section","synth_brass_1","synth_brass_2","soprano_sax","alto_sax","tenor_sax","baritone_sax","oboe","english_horn","bassoon","clarinet","piccolo","flute","recorder","pan_flute","blown_bottle","shakuhachi","whistle","ocarina","lead_1_square","lead_2_sawtooth","lead_3_calliope","lead_4_chiff","lead_5_charang","lead_6_voice","lead_7_fifths","lead_8_bass__lead","pad_1_new_age","pad_2_warm","pad_3_polysynth","pad_4_choir","pad_5_bowed","pad_6_metallic","pad_7_halo","pad_8_sweep","fx_1_rain","fx_2_soundtrack","fx_3_crystal","fx_4_atmosphere","fx_5_brightness","fx_6_goblins","fx_7_echoes","fx_8_scifi","sitar","banjo","shamisen","koto","kalimba","bagpipe","fiddle","shanai","tinkle_bell","agogo","steel_drums","woodblock","taiko_drum","melodic_tom","synth_drum","reverse_cymbal","guitar_fret_noise","breath_noise","seashore","bird_tweet","telephone_ring","helicopter","applause","gunshot","percussion"];async function Rn(e){var t=e.indexOf("MIDI.Soundfont.");if(t<0)throw Error("Invalid MIDI.js Soundfont format:");t=e.indexOf("=",t)+2;var n=e.lastIndexOf(",");let s=JSON.parse(e.slice(t,n)+"}");const i=Object.entries(s).map(async([o,u])=>{const c=u.slice(u.indexOf(",")+1),l=Uint8Array.from(atob(c),d=>d.charCodeAt(0)).buffer,a=zn(l);return[o,await a]}),r=await Promise.all(i);return Object.fromEntries(r)}function zn(e){return new Promise((t,n)=>{re().decodeAudioData(e,t,n)})}let Me;function re(){if(Me===void 0){const e=window.AudioContext||window.webkitAudioContext;Me=new e}return Me}let it=Wt();const ot=B(!0);function Ms(){it.set(ot,!1),Vn()}function Vn(){re().close(),Me=void 0}function Ns(){it.set(ot,!0)}function Dt(){return it.get(ot)}function jn(e){return["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"][e%12]+gn(e)}ie()&&(document.addEventListener("touchstart",Fe),document.addEventListener("touchend",Fe));function Fe(){const e=re();if(e){var t=e.createBuffer(1,1,22050),n=e.createBufferSource();n.buffer=t,n.connect(e.destination),n.start?n.start(0):n.play?n.play(0):n.noteOn&&n.noteOn(0),document.removeEventListener("touchstart",Fe),document.removeEventListener("touchend",Fe)}}const et={},_e={};async function Ln(e){if(et[e])return Promise.resolve();if(_e[e])return _e[e];const t=fetch(`/soundfonts/FluidR3_GM/${e}-mp3.js`);let n;_e[e]=new Promise(s=>n=s);try{let s=await Rn(await(await t).text());et[e]=s,delete _e[e],n()}catch(s){console.error(`Error fetching soundfont for: ${e}`,s)}}function qn(e){return e&&be.find(t=>t===e)}async function tt(e){return ie()?(typeof e=="number"&&(e=be[e]),qn(e)||(console.log("Invalid instrument: ",e,"reverting to acoustic_grand_piano."),e=be[0]),await Ln(e),new $n(e)):{playNote(){},stopNote(){},setMasterVolume(){},getInstrument(){return be[0]}}}function Gt(e){return new Wn(e)}class Wn{synth;masterVolume;constructor(t){this.masterVolume=1,tt(t).then(n=>{this.synth=n,this.synth.setMasterVolume(this.masterVolume)})}playNote(t,n){this.synth?.playNote(t,n)}stopNote(t){this.synth?.stopNote(t)}setMasterVolume(t){this.masterVolume=t,this.synth?.setMasterVolume(t)}getInstrument(){return this.synth?.getInstrument()??be[0]}}class $n{soundfont;masterVolume;instrument;playing=new Map;constructor(t){const n=et[t];if(!n)throw new Error("May not instantiate a synth before its instrument has loaded: "+t);this.instrument=t,this.soundfont=n,this.masterVolume=1}playNote(t,n=127/2){if(te.pressOutput(t,this.masterVolume),!Dt())return;const s=jn(t),i=re(),r=i.createBufferSource();r.buffer=this.soundfont[s];const o=i.createGain();o.gain.value=n/127*this.masterVolume,r.connect(o),o.connect(i.destination),r.start(),this.playing.set(t,{gainNode:o,velocity:n,sourceNode:r})}stopNote(t){if(te.releaseOutput(t),!this.playing.has(t)||!Dt())return;const s=re().currentTime,{gainNode:i,sourceNode:r}=this.playing.get(t);i.gain.exponentialRampToValueAtTime(i.gain.value===0?parseFloat("1.40130e-44"):i.gain.value,s),i.gain.exponentialRampToValueAtTime(.01,s+.5),r.stop(s+.5),this.playing.delete(t)}setMasterVolume(t){this.masterVolume=t;for(let{gainNode:n,velocity:s}of this.playing.values())n.gain.value=s/127*this.masterVolume}getInstrument(){return this.instrument}}function J(e){return e+1}const Te=300,Rt=50;function Jn(){const e=B(0),t=B(0),n=B(0),s=B(0),i=B(0),r=B(0),o=B(l=>l(e)*100+l(t)*50-l(s)*25+l(i)),u=B(l=>{const a=l(c)+l(n)+l(s);return a===0?100:Math.round(100*l(c)/a)}),c=B(l=>l(e)+l(t));return{perfect:e,good:t,missed:n,error:s,durationHeld:i,combined:o,accuracy:u,streak:r}}class Kn{store;state=B("CannotPlay");score=Jn();song=B(null);playInterval=null;currentSongTime=0;volume=B(1);bpmModifier=B(1);currentBpmIndex=B(0);currentBpm=B(t=>(t(this.song)?.bpms[t(this.currentBpmIndex)]?.bpm??120)*t(this.bpmModifier));metronomeVolume=B(0);metronomeSpeed=B(1);metronomeEmphasizeFirst=B(!1);metronomeLastPlayedTick=null;metronomeSynth=Gt("woodblock");metronomeAccentedSynth=Gt("agogo");currentIndex=0;lastIntervalFiredTime=0;playing=[];synths=[];handlers={};range=B(null);hand="both";wait=!1;songHands={};hitNotes=new Set;missedNotes=new Set;midiPressedNotes=new Set;lateNotes=new Map;skipMissedNotes=!1;constructor(t){this.store=t,te.subscribe(n=>this.processMidiEvent(n))}getSong(){return this.store.get(this.song)}clearMissedNotes_(){let t=0;for(const[n,s]of this.lateNotes.entries())this.calcDiff(this.currentSongTime,s.time)>Te&&(this.lateNotes.delete(n),t++,this.missedNotes.add(s));t>0&&this.store.set(this.score.streak,0),this.store.set(this.score.missed,n=>n+t)}processMidiEvent(t){if(!this.getSong())return;const s=t.note;if(t.type==="up"){this.midiPressedNotes.delete(s);return}else this.midiPressedNotes.add(s);this.isPlaying()&&this.processScoreData(s)}processScoreData(t){this.clearMissedNotes_();const n=this.lateNotes.get(t);if(n){const i=this.currentSongTime;this.lateNotes.delete(t);const r=this.calcDiff(i,n.time),o=r<Te;if(r<Rt?this.store.set(this.score.perfect,J):r<Te&&this.store.set(this.score.good,J),o){this.store.set(this.score.streak,J),this.hitNotes.add(n),this.skipMissedNotes&&this.playNote(n);return}}const s=this.getUpcomingNotes()?.find(i=>i.midiNote===t);if(s&&!qe(this,s)){const i=this.calcDiff(s.time,this.currentSongTime);if(i<Te){i<Rt?this.store.set(this.score.perfect,J):this.store.set(this.score.good,J),this.store.set(this.score.streak,J),this.hitNotes.add(s);return}}this.store.set(this.score.error,J),this.store.set(this.score.streak,0)}calcDiff(t,n){return(t-n)*1e3/this.store.get(this.bpmModifier)}getUpcomingNotes(){const t=this.getSong(),n=t?.notes[this.currentIndex];if(!n)return[];const s=[];for(let i=this.currentIndex;i<t.notes.length&&t.notes[i].time===n.time;i++)s.push(t.notes[i]);return s}setWait(t){this.wait=t}isPlaying(){return this.store.get(this.state)==="Playing"}async setSong(t,n){this.stop(),this.resetMetronome(),this.store.set(this.song,t),this.songHands=cn(n),this.store.set(this.state,"CannotPlay");const s=[];Object.entries(t.tracks).forEach(async([i,r])=>{const o=n.tracks[+i]?.instrument??r.program??r.instrument??0;s[+i]=tt(o)}),await Promise.all(s).then(i=>{this.synths=i,Object.entries(t.tracks).forEach(([r])=>{const o=n.tracks[+r]?.sound?1:0;this.setTrackVolume(+r,o)}),this.store.set(this.state,"Paused")}),this.wait=n.waiting}setVolume(t){this.store.set(this.volume,t),this.synths?.forEach(s=>{s?.setMasterVolume(t)});const n=this.getSong()?.backing;n&&(n.volume=.15*t)}setTrackVolume(t,n){this.synths?.[+t]?.setMasterVolume(n)}async setTrackInstrument(t,n){const s=await tt(n);this.synths[+t]=s}isActiveHand(t){const{left:n,right:s}=this.songHands;return n!==t.track&&s!==t.track?!1:this.hand==="both"||this.hand==="left"&&t.track===n||this.hand==="right"&&t.track===s}getTime(){const n=this.getSong();if(!n)return 0;if(n?.backing)return n.backing.currentTime;if(!this.isPlaying())return Math.max(0,this.currentSongTime-0);if(this.wait&&!qe(this,n.notes[this.currentIndex]))return this.currentSongTime-0;const i=performance.now()-this.lastIntervalFiredTime;return Math.max(0,this.currentSongTime+i/1e3-0)}getBpm(){return this.currentBpm}increaseBpm(){this.store.set(this.bpmModifier,vt(this.store.get(this.bpmModifier)+.05,2));const n=this.getSong()?.backing;n&&(n.playbackRate=this.store.get(this.bpmModifier))}decreaseBpm(){this.store.set(this.bpmModifier,vt(this.store.get(this.bpmModifier)-.05,2));const n=this.getSong()?.backing;n&&(n.playbackRate=this.store.get(this.bpmModifier))}getBpmModifier(){return this.bpmModifier}setHand(t){this.hand=t}getBpmIndexForTime(t){const n=this.getSong();if(!n)return 0;const s=n.bpms.findIndex(i=>i.time>t)-1;return s<0?n.bpms.length-1:s}getMeasureForTime(t){const n=this.getSong();if(!n)return{type:"measure",number:0,duration:0,time:0};let s=n.measures.findIndex(i=>i.time>t)-1;return s<0&&(s=n.measures.length-1),n.measures[s]}play(){if(this.isPlaying()||this.store.get(this.state)==="CannotPlay")return;this.currentSongTime>=this.getDuration()&&this.seek(0);const t=this.getSong()?.backing;t&&(t.volume=.15,t.play()),this.store.set(this.state,"Playing"),this.lastIntervalFiredTime=performance.now(),this.playInterval=setInterval(()=>this.playLoop_(),1),this.playing.forEach(n=>this.playNote(n))}playNote(t){this.synths[t.track].playNote(t.midiNote,t.velocity)}stopNotes(t){if(!(t.length===0||this.synths.length===0))for(let n of t)this.synths[n.track].stopNote(n.midiNote)}updateTime_(){const t=this.getSong()?.backing;if(t){const s=t.currentTime+re().outputLatency;this.currentSongTime=s}let n=0;if(this.isPlaying()){const s=performance.now();n=(s-this.lastIntervalFiredTime)*this.store.get(this.bpmModifier),this.lastIntervalFiredTime=s,this.currentSongTime+=n/1e3}return this.currentSongTime}playLoop_(){const t=this.getSong();if(!t)return;const n=this.currentSongTime;let s=this.updateTime_();this.currentSongTime>=this.getDuration()&&(this.seek(this.getDuration()),this.pause());const i=this.store.get(this.range);if(i){let[c,l]=i;if(n<=l&&l<=s){this.seek(c-.5);return}}t.bpms[this.store.get(this.currentBpmIndex)+1]?.time<s&&this.store.set(this.currentBpmIndex,J);const r=c=>c.time+c.duration>s;this.stopNotes(this.playing.filter(c=>!r(c))),this.playing=this.playing.filter(r);const o=this.getLatestMetronomeTick(s);this.metronomeLastPlayedTick!==o&&(this.metronomeLastPlayedTick=o,this.metronomeSynth.playNote(this.isMetronomeTickAccented(o)?90:75,this.store.get(this.metronomeVolume)*127)),this.clearMissedNotes_();const u=this.playing.filter(c=>this.midiPressedNotes.has(c.midiNote)&&this.hitNotes.has(c)).length;for(u>0&&this.store.set(this.score.durationHeld,c=>c+u);t.notes[this.currentIndex]?.time<s;){const c=t.notes[this.currentIndex];if(this.isActiveHand(c))if(this.wait&&!this.hitNotes.has(c)){this.currentSongTime=c.time;return}else!this.hitNotes.has(c)&&n<c.time&&this.lateNotes.set(c.midiNote,c);this.playing.push(c),(!this.skipMissedNotes||!this.isActiveHand(c)||qe(this,c))&&this.playNote(c),this.currentIndex++}}getLatestMetronomeTick(t){const n=this.getSong();if(!n)return 0;const i=n.ppq*(4/(n.timeSignature?.denominator??4))/this.store.get(this.metronomeSpeed),r=n.secondsToTicks(t);return Math.trunc(r/i)*i}isMetronomeTickAccented(t){const n=this.getSong();if(!n)return!1;const s=n.timeSignature?.numerator??4,i=n.ppq*(4/(n.timeSignature?.denominator??4));return this.store.get(this.metronomeEmphasizeFirst)&&t/i%s===0}toggle(){if(this.isPlaying()){this.pause();return}this.play()}stopAllSounds(){this.stopNotes(this.playing)}pause(){this.isPlaying()&&(this.store.set(this.state,"Paused"),clearInterval(this.playInterval),this.store.get(this.song)?.backing?.pause(),this.playInterval=null,this.stopAllSounds())}restart(){const t=this.store.get(this.range);if(t==null){this.stop();return}const[n,s]=t;this.pause(),this.seek(n),this.resetStats_()}stop(){this.pause(),this.reset_()}reset_(){this.currentSongTime=0,this.currentIndex=0,this.playing=[],this.lateNotes.clear(),this.store.set(this.range,null);const t=this.store.get(this.song)?.backing;t&&(t.currentTime=0),this.resetStats_()}resetStats_(){this.hitNotes.clear(),this.missedNotes.clear(),this.store.set(this.score.good,0),this.store.set(this.score.missed,0),this.store.set(this.score.perfect,0),this.store.set(this.score.error,0),this.store.set(this.score.durationHeld,0),this.store.set(this.score.streak,0)}resetMetronome(){this.store.set(this.metronomeVolume,0),this.store.set(this.metronomeSpeed,1),this.store.set(this.metronomeEmphasizeFirst,!1)}seek(t){const n=this.getSong();n&&(this.stopAllSounds(),this.currentSongTime=t,n.backing&&(n.backing.currentTime=t),this.playing=n.notes.filter(s=>s.time<this.currentSongTime&&this.currentSongTime<s.time+s.duration),this.currentIndex=n.notes.findIndex(s=>s.time>=this.currentSongTime),this.store.set(this.currentBpmIndex,this.getBpmIndexForTime(t)),this.metronomeLastPlayedTick=this.getLatestMetronomeTick(t),this.metronomeLastPlayedTick==n.secondsToTicks(t)&&this.metronomeLastPlayedTick--,this.missedNotes.clear(),this.hitNotes.clear(),this.lateNotes.clear())}getRealTimeDuration(t,n){return n-t}getDuration(){return this.store.get(this.song)?.duration??0}setRange(t){if(!t){this.store.set(this.range,null);return}const{start:n,end:s}=t;this.store.set(this.range,[Math.min(n,s),Math.max(n,s)])}getRange(){return this.range}}function qe(e,t){return t?e.hitNotes.has(t):!1}function As(e,t){return t?e.missedNotes.has(t):!1}const cr=L.createContext(null);function Ps({children:e}){const t=rt(),[n,s]=L.useState(()=>new Kn(t));return ur.jsx(cr.Provider,{value:n,children:e})}function Fs(){const e=L.useContext(cr);if(!e)throw new Error("Missing PlayerProvider");return e}export{bs as $,rs as A,ts as B,is as C,cs as D,Pn as E,ws as F,xs as G,_s as H,Qn as I,Fn as J,Ms as K,Ns as L,Is as M,Ts as N,Ss as O,Ps as P,ot as Q,Kn as R,Wt as S,fs as T,ln as U,vs as V,gn as W,ks as X,qe as Y,us as Z,As as _,Gt as a,wt as a0,An as a1,ps as b,Tr as c,be as d,Cs as e,ls as f,tt as g,ms as h,ie as i,Sr as j,ns as k,gs as l,te as m,as as n,os as o,hs as p,ss as q,vt as r,B as s,ds as t,Fs as u,ys as v,Xn as w,Yn as x,es as y,Zn as z};
